<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>å­—æ¯æ³¡æ³¡ - è®¤è¯†ä¸ç†Ÿæ‚‰è‹±æ–‡å­—æ¯</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <script defer src="./assets/achievements.js"></script>
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#4F46E5',
                        secondary: '#10B981',
                        accent: '#F59E0B',
                        danger: '#EF4444',
                        bubble: '#60A5FA'
                    },
                    fontFamily: {
                        kids: ['"Comic Sans MS"', '"Marker Felt"', 'Arial', 'sans-serif']
                    }
                }
            }
        }
    </script>
    
    <style>
        .bubble {
            width: 70px;
            height: 70px;
            background: #60A5FA;
            border-radius: 50%;
            position: absolute;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.75rem;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .bubble:hover {
            transform: scale(1.1);
            background: #3B82F6;
        }
        
        .bubble:active {
            transform: scale(0.95);
        }
        
        .bubble.correct {
            background: #10B981;
            animation: pop 0.5s ease-out;
        }
        
        .bubble.wrong {
            background: #EF4444;
            animation: shake 0.5s ease-in-out;
        }
        
        @keyframes pop {
            0% { transform: scale(1); }
            50% { transform: scale(1.3); }
            100% { transform: scale(0) rotate(180deg); opacity: 0; }
        }
        
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }
        
        .bubbles-container {
            position: relative;
            width: 100%;
            height: 420px;
            overflow: hidden;
            touch-action: none; /* æå‰æ•è·pointerï¼Œé¿å…ç‚¹å‡»åæµè§ˆå™¨å»¶è¿Ÿä¸ä½ç§» */
        }
        /* æç¤ºä¸ç‰¹æ•ˆ */
        .ring-burst {
            position: absolute;
            left: 0; top: 0;
            width: 20px; height: 20px;
            border-radius: 9999px;
            border: 3px solid currentColor;
            pointer-events: none;
            opacity: 0.9;
            transform-origin: center;
            will-change: transform, opacity;
            animation: ring-burst 700ms ease-out forwards;
        }
        @keyframes ring-burst {
            0%   { transform: translate(-50%, -50%) scale(0.4); opacity: 0.95; }
            100% { transform: translate(-50%, -50%) scale(2.8); opacity: 0; }
        }
        .toast-tip {
            position: fixed;
            padding: 6px 10px;
            background: rgba(239, 68, 68, 0.95);
            color: #fff;
            border-radius: 12px;
            font-size: 12px;
            box-shadow: 0 6px 18px rgba(0,0,0,0.2);
            z-index: 9999;
            transform: translate(-50%, -50%);
            animation: tipfade 900ms ease-out forwards;
        }
        @keyframes tipfade { 0%{ opacity:1; transform: translate(-50%, -60%);} 100%{ opacity:0; transform: translate(-50%, -80%);} }
        /* ä»å·¦å³ä¸¤ä¾§â€œé£å‡ºâ€çš„åŠ¨ç”»ä¸æ–¹å‘ç±» */
        @keyframes fly-right {
            0% { left: -90px; opacity: 0.9; }
            100% { left: calc(100% + 90px); opacity: 0.9; }
        }
        @keyframes fly-left {
            0% { left: calc(100% + 90px); opacity: 0.9; }
            100% { left: -90px; opacity: 0.9; }
        }
        .from-left { animation-name: fly-right; animation-timing-function: linear; }
        .from-right { animation-name: fly-left; animation-timing-function: linear; }
        
        @media (max-width: 768px) {
            .bubble {
                width: 60px;
                height: 60px;
                font-size: 1.5rem;
            }
            .bubbles-container {
                height: 360px;
            }
        }
        
        @media (max-width: 480px) {
            .bubble {
                width: 50px;
                height: 50px;
                font-size: 1.25rem;
            }
            .bubbles-container {
                height: 300px;
            }
        }
    </style>
</head>
<body class="bg-gradient-to-br from-blue-50 via-purple-50 to-pink-50 min-h-screen font-kids">
    <!-- å¼€å§‹ç•Œé¢ -->
    <div id="start-screen" class="flex flex-col items-center justify-center min-h-screen p-6">
        <button onclick="window.location.href='index.html'" class="absolute top-4 right-4 bg-white/90 px-4 py-2 rounded-full shadow-lg">
            <i class="fa fa-home mr-2"></i>é¦–é¡µ
        </button>
        
        <div class="text-center max-w-lg mx-auto bg-white rounded-3xl shadow-2xl p-8">
            <h1 class="text-2xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-primary to-secondary mb-3">å­—æ¯æ³¡æ³¡</h1>
            <p class="text-base mb-4">åœ¨å€’è®¡æ—¶å†…ï¼Œæˆ³ä¸­è¦æ±‚çš„å­—æ¯æ³¡æ³¡ï¼Œè¾¾æ ‡å³è¿‡å…³ï¼<br>ä»è®¤è¯†å•ä¸ªå­—æ¯â†’å¤šä¸ªå­—æ¯â†’åˆ°å•è¯åŒ…å«çš„å­—æ¯ã€‚</p>
            
            <div class="flex justify-center mb-4">
                <div class="w-16 h-16 bg-gradient-to-br from-bubble to-blue-600 rounded-full flex items-center justify-center text-white text-2xl shadow-lg">
                    <i class="fa fa-bullseye"></i>
                </div>
            </div>
            
            <!-- éš¾åº¦é€‰æ‹© -->
            <div class="mb-4">
                <h3 class="text-sm font-bold mb-2">é€‰æ‹©éš¾åº¦</h3>
                <div class="flex justify-center gap-2">
                    <button class="difficulty-btn active" data-difficulty="easy">
                        <span class="text-base">ğŸ˜Š ç®€å•</span>
                        <span class="text-xs">3-4å­—æ¯</span>
                    </button>
                    <button class="difficulty-btn" data-difficulty="medium">
                        <span class="text-base">ğŸ¤” ä¸­ç­‰</span>
                        <span class="text-xs">5-6å­—æ¯</span>
                    </button>
                    <button class="difficulty-btn" data-difficulty="hard">
                        <span class="text-base">ğŸ”¥ å›°éš¾</span>
                        <span class="text-xs">7+å­—æ¯</span>
                    </button>
                </div>
            </div>
            
            <div id="badge-preview" class="mb-6">
                <h3 class="text-sm font-bold mb-2">æˆ‘çš„å¾½ç« </h3>
                <div id="badge-preview-grid" class="flex justify-center gap-3 flex-wrap"></div>
                
            </div>

            <button id="start-btn" class="bg-accent hover:bg-yellow-400 text-white font-bold py-3 px-6 rounded-full text-lg shadow-lg">
                å¼€å§‹æ¸¸æˆ <i class="fa fa-play ml-2"></i>
            </button>
        </div>
    </div>

    <script>
    (function(){
      const GAME_KEY = 'wordBubbles';
      const badgeDefs = [
        { id: 'first_burst', name: 'é¦–ç ´æ³¡æ³¡', icon: 'ğŸ¯' },
        { id: 'combo_10', name: 'è¿å‡»è¾¾äºº', icon: 'ğŸ”¥' },
        { id: 'speed_finish', name: 'æé€Ÿæ‹¼è¯', icon: 'âš¡' },
        { id: 'level_reach', name: 'é—¯å…³èƒ½æ‰‹', icon: 'ğŸ†' },
        { id: 'perfect_round', name: 'å®Œç¾å›åˆ', icon: 'ğŸ’' }
      ];
      function getEarnedIds(){
        try { return JSON.parse(localStorage.getItem('earnedAchievements_' + GAME_KEY) || '[]'); } catch(_) { return []; }
      }
      function renderBadgePreview(){
        const grid = document.getElementById('badge-preview-grid');
        if(!grid) return;
        const owned = new Set(getEarnedIds());
        grid.innerHTML = badgeDefs.map(a => {
          const earned = owned.has(a.id);
          const base = earned ? 'from-yellow-100 to-orange-100 border-yellow-300 text-amber-900' : 'from-gray-50 to-gray-100 border-gray-200 text-gray-400 opacity-80';
          return `
            <div class="relative w-20 h-20 rounded-2xl border-2 bg-gradient-to-br ${base} shadow-sm flex flex-col items-center justify-center overflow-hidden" title="${a.name}">
              <div class="text-2xl mb-1">${a.icon}</div>
              <div class="text-[10px] font-bold text-center leading-tight px-1">${a.name}</div>
          ${earned ? '<div class=\"absolute right-1 top-1 bg-amber-400 text-white text-[10px] px-1 rounded-full shadow\">å·²è·</div>' : '<div class=\"absolute right-1 top-1 bg-gray-400 text-white text-[10px] px-1 rounded-full shadow\">æœªè·</div>'}
            </div>`;
        }).join('');
      }
      document.addEventListener('DOMContentLoaded', renderBadgePreview);
    })();
    </script>

    <!-- æ¸¸æˆç•Œé¢ -->
    <div id="game-screen" class="hidden h-screen flex flex-col">
        <!-- é¡¶éƒ¨ä¿¡æ¯æ  -->
        <div class="flex justify-between items-center p-4 bg-white/80 backdrop-blur-sm shadow-md">
            <div class="flex items-center gap-3">
                <button onclick="window.location.href='index.html'" class="bg-white/90 px-3 py-2 rounded-full shadow-md">
                    <i class="fa fa-home mr-1"></i>é¦–é¡µ
                </button>
                <div class="bg-primary px-4 py-2 rounded-full text-white font-bold">
                    å…³å¡ <span id="level-display">1</span>
                </div>
                <div class="bg-secondary px-4 py-2 rounded-full text-white font-bold">
                    åˆ†æ•° <span id="score-display">0</span>
                </div>
            </div>
            
            <div id="timer" class="bg-accent text-white px-6 py-3 rounded-full shadow-md">
                <i class="fa fa-clock-o mr-2"></i>
                æ—¶é—´ <span id="countdown" class="text-3xl font-bold">15</span>
            </div>
            
            <div class="bg-gradient-to-r from-purple-500 to-pink-500 px-4 py-2 rounded-full text-white font-bold">
                <i class="fa fa-bolt mr-2"></i>
                <span id="combo-display">0</span>
            </div>
        </div>
        
        <!-- ä¸»è¦æ¸¸æˆåŒºåŸŸ -->
        <div class="flex-1 flex flex-col justify-center items-center p-4 relative">
            <!-- å›¾ç‰‡æ˜¾ç¤ºåŒºåŸŸï¼ˆæ­¤ç©æ³•ä¸éœ€è¦ï¼Œå…ˆéšè—ï¼‰ -->
            <div id="image-container" class="hidden mb-8 text-center">
                <div id="image-placeholder" class="w-48 h-48 bg-gradient-to-br from-blue-100 to-purple-100 rounded-2xl shadow-lg flex items-center justify-center text-6xl text-gray-400"></div>
            </div>
            
            <!-- ç›®æ ‡æ˜¾ç¤ºåŒºåŸŸ -->
            <div id="word-display" class="mb-4 text-center">
                <div id="targets-display" class="text-base md:text-lg font-bold text-gray-800 bg-gradient-to-r from-yellow-100 to-orange-100 px-6 py-3 rounded-2xl shadow-lg border-2 border-yellow-300 inline-block"></div>
            </div>
            
            <!-- æç¤ºåŒºåŸŸ -->
            <div id="hint-area" class="mb-6 text-center">
                <div class="bg-gradient-to-r from-blue-50 to-purple-50 px-4 py-2 rounded-xl shadow-sm border border-blue-100 inline-block">
                    <p id="hint-text" class="text-blue-700 text-xs md:text-sm">ğŸ¯ ç›®æ ‡ï¼šæˆ³ä¸­æŒ‡å®šå­—æ¯è¾¾åˆ°æ•°é‡</p>
                </div>
            </div>
            
            <!-- æ³¡æ³¡åŒºåŸŸ -->
            <div id="bubbles-container" class="bubbles-container mx-auto max-w-4xl">
                <!-- æ³¡æ³¡ä¼šåŠ¨æ€ç”Ÿæˆåœ¨è¿™é‡Œ -->
            </div>
        </div>
    </div>

    <script>
        // æ¸¸æˆçŠ¶æ€ï¼ˆå­—æ¯ç›®æ ‡ç©æ³•ï¼‰
        let gameState = {
            level: 1,
            score: 0,
            combo: 0,
            isGameActive: false,
            timer: null,
            spawnTimer: null,
            timeLeft: 20,
            currentDifficulty: 'easy',
            targets: [], // [{letter:'A', need:3, got:0}]
            spawnIntervalMs: 1000,
            maxBubbles: 14
        };

        // å•è¯æ•°æ®åº“ - æ‰©å……ç‰ˆ
        const wordDatabase = {
            easy: [
                // åŠ¨ç‰©ç±»
                { word: 'CAT', hint: 'å–µå–µå«çš„åŠ¨ç‰©' },
                { word: 'DOG', hint: 'äººç±»æœ€å¥½çš„æœ‹å‹' },
                { word: 'BIRD', hint: 'ä¼šé£çš„åŠ¨ç‰©' },
                { word: 'FISH', hint: 'æ°´é‡Œæ¸¸çš„åŠ¨ç‰©' },
                { word: 'RABBIT', hint: 'é•¿è€³æœµçš„åŠ¨ç‰©' },
                { word: 'DUCK', hint: 'ä¼šæ¸¸æ³³çš„é¸Ÿ' },
                { word: 'CHICKEN', hint: 'ä¼šä¸‹è›‹çš„åŠ¨ç‰©' },
                { word: 'COW', hint: 'äº§å¥¶çš„åŠ¨ç‰©' },
                { word: 'PIG', hint: 'ç²‰è‰²çš„å†œåœºåŠ¨ç‰©' },
                { word: 'BEAR', hint: 'æ£•è‰²çš„ç†Š' },
                { word: 'PANDA', hint: 'é»‘ç™½ç›¸é—´çš„ç†ŠçŒ«' },
                { word: 'TIGER', hint: 'æ¡çº¹çš„è€è™' },
                { word: 'LION', hint: 'è‰åŸä¹‹ç‹' },
                { word: 'MONKEY', hint: 'ä¼šçˆ¬æ ‘çš„çŒ´å­' },
                { word: 'ELEPHANT', hint: 'é•¿é¼»å­çš„å¤§è±¡' },
                { word: 'ZEBRA', hint: 'é»‘ç™½æ¡çº¹çš„æ–‘é©¬' },
                { word: 'ANT', hint: 'å°èš‚èš' },
                { word: 'BEE', hint: 'ä¼šé‡‡èœœçš„èœœèœ‚' },
                { word: 'BUTTERFLY', hint: 'ç¾ä¸½çš„è´è¶' },
                { word: 'FROG', hint: 'ä¼šè·³çš„é’è›™' },
                
                // é£Ÿç‰©ç±»
                { word: 'APPLE', hint: 'çº¢è‰²çš„æ°´æœ' },
                { word: 'BANANA', hint: 'é»„è‰²çš„æ°´æœ' },
                { word: 'ORANGE', hint: 'æ©™è‰²çš„æ°´æœ' },
                { word: 'GRAPE', hint: 'ç´«è‰²çš„å°æ°´æœ' },
                { word: 'WATERMELON', hint: 'å¤§è¥¿ç“œ' },
                { word: 'STRAWBERRY', hint: 'çº¢è‰²çš„è‰è“' },
                { word: 'CAKE', hint: 'ç”Ÿæ—¥æ—¶åƒçš„ç”œç‚¹' },
                { word: 'BREAD', hint: 'é¢åŒ…' },
                { word: 'MILK', hint: 'ç™½è‰²çš„ç‰›å¥¶' },
                { word: 'EGG', hint: 'é¸¡è›‹' },
                { word: 'RICE', hint: 'ç±³é¥­' },
                { word: 'NOODLES', hint: 'é¢æ¡' },
                { word: 'ICE CREAM', hint: 'å†°æ·‡æ·‹' },
                { word: 'JUICE', hint: 'æœæ±' },
                { word: 'WATER', hint: 'æ°´' },
                { word: 'CANDY', hint: 'ç³–æœ' },
                { word: 'CHOCOLATE', hint: 'å·§å…‹åŠ›' },
                { word: 'COOKIE', hint: 'é¥¼å¹²' },
                { word: 'VEGETABLE', hint: 'è”¬èœ' },
                { word: 'FRUIT', hint: 'æ°´æœ' },
                
                // é¢œè‰²å’Œå½¢çŠ¶
                { word: 'RED', hint: 'çº¢è‰²' },
                { word: 'YELLOW', hint: 'é»„è‰²' },
                { word: 'BLUE', hint: 'è“è‰²' },
                { word: 'GREEN', hint: 'ç»¿è‰²' },
                { word: 'PINK', hint: 'ç²‰è‰²' },
                { word: 'BLACK', hint: 'é»‘è‰²' },
                { word: 'WHITE', hint: 'ç™½è‰²' },
                { word: 'CIRCLE', hint: 'åœ†å½¢' },
                { word: 'SQUARE', hint: 'æ­£æ–¹å½¢' },
                { word: 'STAR', hint: 'æ˜Ÿæ˜Ÿ' },
                { word: 'TRIANGLE', hint: 'ä¸‰è§’å½¢' },
                { word: 'HEART', hint: 'çˆ±å¿ƒ' },
                
                // èº«ä½“éƒ¨ä½
                { word: 'HEAD', hint: 'å¤´' },
                { word: 'EYE', hint: 'çœ¼ç›' },
                { word: 'NOSE', hint: 'é¼»å­' },
                { word: 'MOUTH', hint: 'å˜´å·´' },
                { word: 'EAR', hint: 'è€³æœµ' },
                { word: 'HAND', hint: 'æ‰‹' },
                { word: 'ARM', hint: 'æ‰‹è‡‚' },
                { word: 'LEG', hint: 'è…¿' },
                { word: 'FOOT', hint: 'è„š' },
                { word: 'HAIR', hint: 'å¤´å‘' },
                { word: 'FACE', hint: 'è„¸' },
                { word: 'TOOTH', hint: 'ç‰™é½¿' },
                
                // å®¶åº­æˆå‘˜
                { word: 'MOTHER', hint: 'å¦ˆå¦ˆ' },
                { word: 'FATHER', hint: 'çˆ¸çˆ¸' },
                { word: 'BABY', hint: 'å®å®' },
                { word: 'SISTER', hint: 'å§å¦¹' },
                { word: 'BROTHER', hint: 'å…„å¼Ÿ' },
                { word: 'GRANDMA', hint: 'å¥¶å¥¶' },
                { word: 'GRANDPA', hint: 'çˆ·çˆ·' },
                { word: 'FAMILY', hint: 'å®¶åº­' },
                
                // æ•°å­—å’Œæ—¶é—´
                { word: 'ONE', hint: 'ä¸€' },
                { word: 'TWO', hint: 'äºŒ' },
                { word: 'THREE', hint: 'ä¸‰' },
                { word: 'FOUR', hint: 'å››' },
                { word: 'FIVE', hint: 'äº”' },
                { word: 'SIX', hint: 'å…­' },
                { word: 'SEVEN', hint: 'ä¸ƒ' },
                { word: 'EIGHT', hint: 'å…«' },
                { word: 'NINE', hint: 'ä¹' },
                { word: 'TEN', hint: 'å' },
                { word: 'SUN', hint: 'å¤ªé˜³' },
                { word: 'MOON', hint: 'æœˆäº®' },
                { word: 'DAY', hint: 'ç™½å¤©' },
                { word: 'NIGHT', hint: 'å¤œæ™š' },
                { word: 'MORNING', hint: 'æ—©æ™¨' },
                { word: 'TODAY', hint: 'ä»Šå¤©' },
                { word: 'TOMORROW', hint: 'æ˜å¤©' },
                { word: 'CLOCK', hint: 'é’Ÿè¡¨' },
                
                // æ—¥å¸¸ç”¨å“
                { word: 'BALL', hint: 'çƒ' },
                { word: 'DOLL', hint: 'å¨ƒå¨ƒ' },
                { word: 'KITE', hint: 'é£ç­' },
                { word: 'BOOK', hint: 'ä¹¦' },
                { word: 'PENCIL', hint: 'é“…ç¬”' },
                { word: 'CRAYON', hint: 'èœ¡ç¬”' },
                { word: 'BAG', hint: 'ä¹¦åŒ…' },
                { word: 'CHAIR', hint: 'æ¤…å­' },
                { word: 'TABLE', hint: 'æ¡Œå­' },
                { word: 'BED', hint: 'åºŠ' },
                { word: 'DOOR', hint: 'é—¨' },
                { word: 'WINDOW', hint: 'çª—æˆ·' },
                { word: 'CUP', hint: 'æ¯å­' },
                { word: 'PLATE', hint: 'ç›˜å­' },
                { word: 'SPOON', hint: 'å‹ºå­' },
                { word: 'TOY', hint: 'ç©å…·' },
                { word: 'COMPUTER', hint: 'ç”µè„‘' },
                { word: 'TV', hint: 'ç”µè§†' },
                { word: 'PHONE', hint: 'ç”µè¯' },
                { word: 'LIGHT', hint: 'ç¯' },
                { word: 'CAR', hint: 'å°æ±½è½¦' },
                { word: 'BUS', hint: 'å…¬äº¤è½¦' },
                { word: 'BIKE', hint: 'è‡ªè¡Œè½¦' },
                { word: 'BOAT', hint: 'å°èˆ¹' },
                { word: 'HOUSE', hint: 'æˆ¿å­' },
                { word: 'TREE', hint: 'æ ‘' },
                { word: 'FLOWER', hint: 'èŠ±' },
                { word: 'BALLOON', hint: 'æ°”çƒ' },
                
                // åŠ¨ä½œåŠ¨è¯
                { word: 'RUN', hint: 'è·‘' },
                { word: 'JUMP', hint: 'è·³' },
                { word: 'PLAY', hint: 'ç©' },
                { word: 'EAT', hint: 'åƒ' },
                { word: 'DRINK', hint: 'å–' },
                { word: 'READ', hint: 'è¯»' },
                { word: 'DRAW', hint: 'ç”»' },
                { word: 'SING', hint: 'å”±æ­Œ' },
                { word: 'DANCE', hint: 'è·³èˆ' },
                { word: 'SLEEP', hint: 'ç¡è§‰' },
                { word: 'SWIM', hint: 'æ¸¸æ³³' },
                { word: 'WALK', hint: 'èµ°è·¯' },
                { word: 'SEE', hint: 'çœ‹è§' },
                { word: 'HEAR', hint: 'å¬è§' },
                { word: 'SAY', hint: 'è¯´' },
                { word: 'LAUGH', hint: 'ç¬‘' },
                { word: 'CRY', hint: 'å“­' },
                { word: 'SIT', hint: 'å' },
                { word: 'STAND', hint: 'ç«™' },
                { word: 'GIVE', hint: 'ç»™' },
                { word: 'LIKE', hint: 'å–œæ¬¢' },
                { word: 'LOVE', hint: 'çˆ±' },
                { word: 'GO', hint: 'å»' },
                { word: 'COME', hint: 'æ¥' },
                { word: 'OPEN', hint: 'æ‰“å¼€' },
                { word: 'CLOSE', hint: 'å…³é—­' },
                { word: 'WASH', hint: 'æ´—' },
                { word: 'HELP', hint: 'å¸®åŠ©' },
                
                // è‡ªç„¶å’Œå¤©æ°”
                { word: 'RAIN', hint: 'é›¨' },
                { word: 'SNOW', hint: 'é›ª' },
                { word: 'CLOUD', hint: 'äº‘' },
                { word: 'WIND', hint: 'é£' },
                { word: 'SKY', hint: 'å¤©ç©º' },
                { word: 'RIVER', hint: 'æ²³æµ' },
                { word: 'MOUNTAIN', hint: 'å±±' },
                { word: 'GRASS', hint: 'è‰' },
                { word: 'SEA', hint: 'æµ·æ´‹' },
                { word: 'HOT', hint: 'çƒ­çš„' },
                { word: 'COLD', hint: 'å†·çš„' },
                { word: 'WARM', hint: 'æš–å’Œçš„' },
                { word: 'SUNNY', hint: 'æ™´æœ—çš„' },
                { word: 'RAINY', hint: 'ä¸‹é›¨çš„' },
                { word: 'RAINBOW', hint: 'å½©è™¹' },
                
                // åœ°ç‚¹å’ŒèŒä¸š
                { word: 'SCHOOL', hint: 'å­¦æ ¡' },
                { word: 'HOME', hint: 'å®¶' },
                { word: 'PARK', hint: 'å…¬å›­' },
                { word: 'ZOO', hint: 'åŠ¨ç‰©å›­' },
                { word: 'SHOP', hint: 'å•†åº—' },
                { word: 'HOSPITAL', hint: 'åŒ»é™¢' },
                { word: 'TEACHER', hint: 'è€å¸ˆ' },
                { word: 'DOCTOR', hint: 'åŒ»ç”Ÿ' },
                { word: 'NURSE', hint: 'æŠ¤å£«' },
                { word: 'POLICEMAN', hint: 'è­¦å¯Ÿ' },
                { word: 'FARMER', hint: 'å†œæ°‘' },
                { word: 'COOK', hint: 'å¨å¸ˆ' },
                { word: 'STUDENT', hint: 'å­¦ç”Ÿ' },
                { word: 'FRIEND', hint: 'æœ‹å‹' },
                { word: 'BOY', hint: 'ç”·å­©' },
                { word: 'GIRL', hint: 'å¥³å­©' }
            ],
            medium: [
                // ä¸­ç­‰éš¾åº¦çš„å•è¯ï¼ˆä¿æŒåŸæœ‰çš„ï¼‰
                { word: 'RESTAURANT', hint: 'é¤å…' },
                { word: 'SUPERMARKET', hint: 'è¶…å¸‚' },
                { word: 'LIBRARY', hint: 'å›¾ä¹¦é¦†' },
                { word: 'MUSEUM', hint: 'åšç‰©é¦†' },
                { word: 'BEACH', hint: 'æµ·æ»©' },
                { word: 'UNIVERSITY', hint: 'å¤§å­¦' },
                { word: 'SUBMARINE', hint: 'æ½œæ°´è‰‡' },
                { word: 'DINOSAUR', hint: 'è¿œå¤çš„æé¾™' },
                { word: 'TELESCOPE', hint: 'æœ›è¿œé•œ' },
                { word: 'MICROSCOPE', hint: 'æ˜¾å¾®é•œ' },
                { word: 'VOLCANO', hint: 'ç«å±±' },
                { word: 'WATERFALL', hint: 'ç€‘å¸ƒ' },
                { word: 'OCEAN', hint: 'æµ·æ´‹' },
                { word: 'FOREST', hint: 'æ£®æ—' },
                { word: 'ASTRONAUT', hint: 'å¤ªç©ºäºº' },
                { word: 'TELEPHONE', hint: 'ç”µè¯' }
            ],
            hard: [
                // å›°éš¾éš¾åº¦çš„å•è¯ï¼ˆä¿æŒåŸæœ‰çš„ï¼‰
                { word: 'ELEPHANT', hint: 'é•¿é¼»å­çš„å¤§è±¡' },
                { word: 'BUTTERFLY', hint: 'ç¾ä¸½çš„è´è¶' },
                { word: 'ASTRONAUT', hint: 'å¤ªç©ºäºº' },
                { word: 'TELEPHONE', hint: 'ç”µè¯' },
                { word: 'COMPUTER', hint: 'ç”µè„‘' },
                { word: 'UNIVERSITY', hint: 'å¤§å­¦' },
                { word: 'SUBMARINE', hint: 'æ½œæ°´è‰‡' },
                { word: 'DINOSAUR', hint: 'è¿œå¤çš„æé¾™' },
                { word: 'TELESCOPE', hint: 'æœ›è¿œé•œ' },
                { word: 'MICROSCOPE', hint: 'æ˜¾å¾®é•œ' },
                { word: 'VOLCANO', hint: 'ç«å±±' },
                { word: 'WATERFALL', hint: 'ç€‘å¸ƒ' },
                { word: 'MOUNTAIN', hint: 'å±±' },
                { word: 'OCEAN', hint: 'æµ·æ´‹' },
                { word: 'FOREST', hint: 'æ£®æ—' }
            ]
        };

        // ç®€å•çš„å›¾æ ‡ç”Ÿæˆå‡½æ•°
        function getIconForWord(word) {
            // ä½¿ç”¨Font Awesomeå›¾æ ‡ï¼Œæ›´ç®€å•ç›´è§‚
            const iconMap = {
                // åŠ¨ç‰©ç±»
                'CAT': 'fa-paw', 'DOG': 'fa-paw', 'RABBIT': 'fa-paw', 'DUCK': 'fa-dove', 'CHICKEN': 'fa-dove', 'COW': 'fa-horse', 'PIG': 'fa-horse', 'BEAR': 'fa-horse', 'PANDA': 'fa-horse', 'TIGER': 'fa-horse', 'LION': 'fa-horse', 'MONKEY': 'fa-horse', 'ELEPHANT': 'fa-horse', 'ZEBRA': 'fa-horse', 'ANT': 'fa-bug', 'BEE': 'fa-bug', 'BUTTERFLY': 'fa-bug', 'FROG': 'fa-fish',
                'BIRD': 'fa-dove', 'FISH': 'fa-fish',
                
                // é£Ÿç‰©ç±»
                'APPLE': 'fa-apple-alt', 'BANANA': 'fa-apple-alt', 'ORANGE': 'fa-apple-alt', 'GRAPE': 'fa-apple-alt', 'WATERMELON': 'fa-apple-alt', 'STRAWBERRY': 'fa-apple-alt', 'CAKE': 'fa-birthday-cake', 'BREAD': 'fa-birthday-cake', 'MILK': 'fa-wine-bottle', 'EGG': 'fa-egg', 'RICE': 'fa-apple-alt', 'NOODLES': 'fa-apple-alt', 'ICE CREAM': 'fa-ice-cream', 'JUICE': 'fa-wine-bottle', 'WATER': 'fa-wine-bottle', 'CANDY': 'fa-candy-cane', 'CHOCOLATE': 'fa-candy-cane', 'COOKIE': 'fa-cookie-bite', 'VEGETABLE': 'fa-carrot', 'FRUIT': 'fa-apple-alt',
                
                // é¢œè‰²å’Œå½¢çŠ¶
                'RED': 'fa-palette', 'YELLOW': 'fa-palette', 'BLUE': 'fa-palette', 'GREEN': 'fa-palette', 'PINK': 'fa-palette', 'BLACK': 'fa-palette', 'WHITE': 'fa-palette', 'CIRCLE': 'fa-circle', 'SQUARE': 'fa-square', 'STAR': 'fa-star', 'TRIANGLE': 'fa-play', 'HEART': 'fa-heart',
                
                // èº«ä½“éƒ¨ä½
                'HEAD': 'fa-user', 'EYE': 'fa-eye', 'NOSE': 'fa-user', 'MOUTH': 'fa-user', 'EAR': 'fa-user', 'HAND': 'fa-hand-paper', 'ARM': 'fa-user', 'LEG': 'fa-user', 'FOOT': 'fa-user', 'HAIR': 'fa-user', 'FACE': 'fa-user', 'TOOTH': 'fa-user',
                
                // å®¶åº­æˆå‘˜
                'MOTHER': 'fa-female', 'FATHER': 'fa-male', 'BABY': 'fa-baby', 'SISTER': 'fa-female', 'BROTHER': 'fa-male', 'GRANDMA': 'fa-female', 'GRANDPA': 'fa-male', 'FAMILY': 'fa-users',
                
                // æ•°å­—å’Œæ—¶é—´
                'ONE': 'fa-hashtag', 'TWO': 'fa-hashtag', 'THREE': 'fa-hashtag', 'FOUR': 'fa-hashtag', 'FIVE': 'fa-hashtag', 'SIX': 'fa-hashtag', 'SEVEN': 'fa-hashtag', 'EIGHT': 'fa-hashtag', 'NINE': 'fa-hashtag', 'TEN': 'fa-hashtag', 'SUN': 'fa-sun', 'MOON': 'fa-moon', 'DAY': 'fa-sun', 'NIGHT': 'fa-moon', 'MORNING': 'fa-sun', 'TODAY': 'fa-calendar-day', 'TOMORROW': 'fa-calendar-day', 'CLOCK': 'fa-clock',
                
                // æ—¥å¸¸ç”¨å“
                'BALL': 'fa-circle', 'DOLL': 'fa-child', 'KITE': 'fa-paper-plane', 'BOOK': 'fa-book', 'PENCIL': 'fa-pencil-alt', 'CRAYON': 'fa-pencil-alt', 'BAG': 'fa-briefcase', 'CHAIR': 'fa-chair', 'TABLE': 'fa-table', 'BED': 'fa-bed', 'DOOR': 'fa-door-open', 'WINDOW': 'fa-window-maximize', 'CUP': 'fa-mug-hot', 'PLATE': 'fa-circle', 'SPOON': 'fa-utensils', 'TOY': 'fa-child', 'COMPUTER': 'fa-laptop', 'TV': 'fa-tv', 'PHONE': 'fa-phone', 'LIGHT': 'fa-lightbulb', 'CAR': 'fa-car', 'BUS': 'fa-bus', 'BIKE': 'fa-bicycle', 'BOAT': 'fa-ship', 'HOUSE': 'fa-home', 'TREE': 'fa-tree', 'FLOWER': 'fa-seedling', 'BALLOON': 'fa-circle',
                
                // åŠ¨ä½œåŠ¨è¯
                'RUN': 'fa-running', 'JUMP': 'fa-running', 'PLAY': 'fa-gamepad', 'EAT': 'fa-utensils', 'DRINK': 'fa-wine-bottle', 'READ': 'fa-book-open', 'DRAW': 'fa-paint-brush', 'SING': 'fa-music', 'DANCE': 'fa-music', 'SLEEP': 'fa-bed', 'SWIM': 'fa-swimming-pool', 'WALK': 'fa-walking', 'SEE': 'fa-eye', 'HEAR': 'fa-ear', 'SAY': 'fa-comment', 'LAUGH': 'fa-laugh', 'CRY': 'fa-sad-tear', 'SIT': 'fa-chair', 'STAND': 'fa-user', 'GIVE': 'fa-hand-holding-heart', 'LIKE': 'fa-heart', 'LOVE': 'fa-heart', 'GO': 'fa-arrow-right', 'COME': 'fa-arrow-left', 'OPEN': 'fa-door-open', 'CLOSE': 'fa-door-closed', 'WASH': 'fa-hands-wash', 'HELP': 'fa-hands-helping',
                
                // è‡ªç„¶å’Œå¤©æ°”
                'RAIN': 'fa-cloud-rain', 'SNOW': 'fa-snowflake', 'CLOUD': 'fa-cloud', 'WIND': 'fa-wind', 'SKY': 'fa-cloud', 'RIVER': 'fa-water', 'MOUNTAIN': 'fa-mountain', 'GRASS': 'fa-seedling', 'SEA': 'fa-water', 'HOT': 'fa-thermometer-full', 'COLD': 'fa-thermometer-empty', 'WARM': 'fa-thermometer-half', 'SUNNY': 'fa-sun', 'RAINY': 'fa-cloud-rain', 'RAINBOW': 'fa-rainbow',
                
                // åœ°ç‚¹å’ŒèŒä¸š
                'SCHOOL': 'fa-graduation-cap', 'HOME': 'fa-home', 'PARK': 'fa-tree', 'ZOO': 'fa-horse', 'SHOP': 'fa-shopping-cart', 'HOSPITAL': 'fa-hospital', 'TEACHER': 'fa-chalkboard-teacher', 'DOCTOR': 'fa-user-md', 'NURSE': 'fa-user-nurse', 'POLICEMAN': 'fa-shield-alt', 'FARMER': 'fa-user-tie', 'COOK': 'fa-utensils', 'STUDENT': 'fa-user-graduate', 'FRIEND': 'fa-users', 'BOY': 'fa-male', 'GIRL': 'fa-female',
                
                // åŸæœ‰çš„å•è¯
                'RESTAURANT': 'fa-utensils', 'SUPERMARKET': 'fa-shopping-cart', 'LIBRARY': 'fa-book', 'MUSEUM': 'fa-landmark', 'BEACH': 'fa-umbrella-beach', 'UNIVERSITY': 'fa-university', 'SUBMARINE': 'fa-ship', 'DINOSAUR': 'fa-dragon', 'TELESCOPE': 'fa-eye', 'MICROSCOPE': 'fa-search', 'VOLCANO': 'fa-fire', 'WATERFALL': 'fa-water', 'OCEAN': 'fa-water', 'FOREST': 'fa-tree', 'ASTRONAUT': 'fa-user-astronaut', 'TELEPHONE': 'fa-phone'
            };

            // å¦‚æœæœ‰é¢„å®šä¹‰çš„å›¾æ ‡ï¼Œç›´æ¥è¿”å›
            if (iconMap[word]) {
                return `<i class="fa ${iconMap[word]}"></i>`;
            }

            // æ™ºèƒ½åŒ¹é…ï¼šæ ¹æ®å•è¯ç‰¹å¾ç”Ÿæˆå›¾æ ‡
            const wordLower = word.toLowerCase();
            
            // åŠ¨ç‰©ç›¸å…³
            if (wordLower.includes('cat') || wordLower.includes('dog') || wordLower.includes('rabbit') || wordLower.includes('duck') || wordLower.includes('chicken') || wordLower.includes('cow') || wordLower.includes('pig') || wordLower.includes('bear') || wordLower.includes('panda') || wordLower.includes('tiger') || wordLower.includes('lion') || wordLower.includes('monkey') || wordLower.includes('elephant') || wordLower.includes('zebra') || wordLower.includes('ant') || wordLower.includes('bee') || wordLower.includes('butterfly') || wordLower.includes('frog')) return '<i class="fa fa-paw"></i>';
            if (wordLower.includes('fish')) return '<i class="fa fa-fish"></i>';
            if (wordLower.includes('bird') || wordLower.includes('duck') || wordLower.includes('chicken')) return '<i class="fa fa-dove"></i>';
            
            // é£Ÿç‰©ç›¸å…³
            if (wordLower.includes('apple') || wordLower.includes('banana') || wordLower.includes('orange') || wordLower.includes('grape') || wordLower.includes('watermelon') || wordLower.includes('strawberry') || wordLower.includes('rice') || wordLower.includes('noodles') || wordLower.includes('ice cream') || wordLower.includes('juice') || wordLower.includes('water') || wordLower.includes('candy') || wordLower.includes('chocolate') || wordLower.includes('cookie') || wordLower.includes('vegetable') || wordLower.includes('fruit')) return '<i class="fa fa-apple-alt"></i>';
            if (wordLower.includes('cake') || wordLower.includes('bread')) return '<i class="fa fa-birthday-cake"></i>';
            if (wordLower.includes('milk') || wordLower.includes('egg')) return '<i class="fa fa-wine-bottle"></i>';
            if (wordLower.includes('pizza')) return '<i class="fa fa-pizza-slice"></i>';
            
            // è‡ªç„¶ç›¸å…³
            if (wordLower.includes('sun') || wordLower.includes('day') || wordLower.includes('morning') || wordLower.includes('sunny')) return '<i class="fa fa-sun"></i>';
            if (wordLower.includes('moon') || wordLower.includes('night')) return '<i class="fa fa-moon"></i>';
            if (wordLower.includes('star')) return '<i class="fa fa-star"></i>';
            if (wordLower.includes('tree') || wordLower.includes('grass')) return '<i class="fa fa-tree"></i>';
            if (wordLower.includes('flower') || wordLower.includes('grass')) return '<i class="fa fa-seedling"></i>';
            if (wordLower.includes('mountain')) return '<i class="fa fa-mountain"></i>';
            if (wordLower.includes('rain') || wordLower.includes('rainy')) return '<i class="fa fa-cloud-rain"></i>';
            if (wordLower.includes('snow')) return '<i class="fa fa-snowflake"></i>';
            if (wordLower.includes('cloud') || wordLower.includes('sky')) return '<i class="fa fa-cloud"></i>';
            if (wordLower.includes('wind')) return '<i class="fa fa-wind"></i>';
            if (wordLower.includes('river') || wordLower.includes('sea') || wordLower.includes('water')) return '<i class="fa fa-water"></i>';
            if (wordLower.includes('rainbow')) return '<i class="fa fa-rainbow"></i>';
            if (wordLower.includes('hot') || wordLower.includes('cold') || wordLower.includes('warm')) return '<i class="fa fa-thermometer-half"></i>';
            
            // é¢œè‰²å’Œå½¢çŠ¶
            if (wordLower.includes('red') || wordLower.includes('yellow') || wordLower.includes('blue') || wordLower.includes('green') || wordLower.includes('pink') || wordLower.includes('black') || wordLower.includes('white')) return '<i class="fa fa-palette"></i>';
            if (wordLower.includes('circle')) return '<i class="fa fa-circle"></i>';
            if (wordLower.includes('square')) return '<i class="fa fa-square"></i>';
            if (wordLower.includes('triangle')) return '<i class="fa fa-play"></i>';
            if (wordLower.includes('heart')) return '<i class="fa fa-heart"></i>';
            
            // èº«ä½“éƒ¨ä½
            if (wordLower.includes('head') || wordLower.includes('nose') || wordLower.includes('mouth') || wordLower.includes('ear') || wordLower.includes('arm') || wordLower.includes('leg') || wordLower.includes('foot') || wordLower.includes('hair') || wordLower.includes('face') || wordLower.includes('tooth')) return '<i class="fa fa-user"></i>';
            if (wordLower.includes('eye')) return '<i class="fa fa-eye"></i>';
            if (wordLower.includes('hand')) return '<i class="fa fa-hand-paper"></i>';
            
            // å®¶åº­æˆå‘˜
            if (wordLower.includes('mother') || wordLower.includes('sister') || wordLower.includes('grandma')) return '<i class="fa fa-female"></i>';
            if (wordLower.includes('father') || wordLower.includes('brother') || wordLower.includes('grandpa')) return '<i class="fa fa-male"></i>';
            if (wordLower.includes('baby')) return '<i class="fa fa-baby"></i>';
            if (wordLower.includes('family')) return '<i class="fa fa-users"></i>';
            
            // æ•°å­—
            if (wordLower.includes('one') || wordLower.includes('two') || wordLower.includes('three') || wordLower.includes('four') || wordLower.includes('five') || wordLower.includes('six') || wordLower.includes('seven') || wordLower.includes('eight') || wordLower.includes('nine') || wordLower.includes('ten')) return '<i class="fa fa-hashtag"></i>';
            
            // æ—¶é—´
            if (wordLower.includes('today') || wordLower.includes('tomorrow')) return '<i class="fa fa-calendar-day"></i>';
            if (wordLower.includes('clock')) return '<i class="fa fa-clock"></i>';
            
            // ç‰©å“ç›¸å…³
            if (wordLower.includes('house') || wordLower.includes('home')) return '<i class="fa fa-home"></i>';
            if (wordLower.includes('car')) return '<i class="fa fa-car"></i>';
            if (wordLower.includes('book')) return '<i class="fa fa-book"></i>';
            if (wordLower.includes('ball') || wordLower.includes('balloon')) return '<i class="fa fa-circle"></i>';
            if (wordLower.includes('hat')) return '<i class="fa fa-hat-cowboy"></i>';
            if (wordLower.includes('pencil') || wordLower.includes('crayon')) return '<i class="fa fa-pencil-alt"></i>';
            if (wordLower.includes('phone') || wordLower.includes('telephone')) return '<i class="fa fa-phone"></i>';
            if (wordLower.includes('computer')) return '<i class="fa fa-laptop"></i>';
            if (wordLower.includes('tv') || wordLower.includes('television')) return '<i class="fa fa-tv"></i>';
            if (wordLower.includes('camera')) return '<i class="fa fa-camera"></i>';
            if (wordLower.includes('clock') || wordLower.includes('watch')) return '<i class="fa fa-clock"></i>';
            if (wordLower.includes('key')) return '<i class="fa fa-key"></i>';
            if (wordLower.includes('door')) return '<i class="fa fa-door-open"></i>';
            if (wordLower.includes('window')) return '<i class="fa fa-window-maximize"></i>';
            if (wordLower.includes('bed')) return '<i class="fa fa-bed"></i>';
            if (wordLower.includes('chair')) return '<i class="fa fa-chair"></i>';
            if (wordLower.includes('table')) return '<i class="fa fa-table"></i>';
            if (wordLower.includes('lamp') || wordLower.includes('light')) return '<i class="fa fa-lightbulb"></i>';
            if (wordLower.includes('mirror')) return '<i class="fa fa-mirror"></i>';
            if (wordLower.includes('bag') || wordLower.includes('backpack')) return '<i class="fa fa-briefcase"></i>';
            if (wordLower.includes('shirt') || wordLower.includes('clothes')) return '<i class="fa fa-tshirt"></i>';
            if (wordLower.includes('shoes')) return '<i class="fa fa-shoe-prints"></i>';
            if (wordLower.includes('glasses')) return '<i class="fa fa-glasses"></i>';
            if (wordLower.includes('umbrella')) return '<i class="fa fa-umbrella"></i>';
            if (wordLower.includes('money')) return '<i class="fa fa-dollar-sign"></i>';
            if (wordLower.includes('gift') || wordLower.includes('present')) return '<i class="fa fa-gift"></i>';
            if (wordLower.includes('toy')) return '<i class="fa fa-gamepad"></i>';
            if (wordLower.includes('robot')) return '<i class="fa fa-robot"></i>';
            if (wordLower.includes('rocket')) return '<i class="fa fa-rocket"></i>';
            if (wordLower.includes('plane') || wordLower.includes('airplane')) return '<i class="fa fa-plane"></i>';
            if (wordLower.includes('train')) return '<i class="fa fa-train"></i>';
            if (wordLower.includes('bus')) return '<i class="fa fa-bus"></i>';
            if (wordLower.includes('bike') || wordLower.includes('bicycle')) return '<i class="fa fa-bicycle"></i>';
            if (wordLower.includes('boat') || wordLower.includes('ship')) return '<i class="fa fa-ship"></i>';
            if (wordLower.includes('doll')) return '<i class="fa fa-child"></i>';
            if (wordLower.includes('kite')) return '<i class="fa fa-paper-plane"></i>';
            if (wordLower.includes('cup') || wordLower.includes('plate') || wordLower.includes('spoon')) return '<i class="fa fa-utensils"></i>';
            
            // åŠ¨ä½œåŠ¨è¯
            if (wordLower.includes('run') || wordLower.includes('jump')) return '<i class="fa fa-running"></i>';
            if (wordLower.includes('play')) return '<i class="fa fa-gamepad"></i>';
            if (wordLower.includes('eat')) return '<i class="fa fa-utensils"></i>';
            if (wordLower.includes('drink')) return '<i class="fa fa-wine-bottle"></i>';
            if (wordLower.includes('read')) return '<i class="fa fa-book-open"></i>';
            if (wordLower.includes('draw')) return '<i class="fa fa-paint-brush"></i>';
            if (wordLower.includes('sing') || wordLower.includes('dance')) return '<i class="fa fa-music"></i>';
            if (wordLower.includes('sleep')) return '<i class="fa fa-bed"></i>';
            if (wordLower.includes('swim')) return '<i class="fa fa-swimming-pool"></i>';
            if (wordLower.includes('walk')) return '<i class="fa fa-walking"></i>';
            if (wordLower.includes('see')) return '<i class="fa fa-eye"></i>';
            if (wordLower.includes('hear')) return '<i class="fa fa-ear"></i>';
            if (wordLower.includes('say')) return '<i class="fa fa-comment"></i>';
            if (wordLower.includes('laugh')) return '<i class="fa fa-laugh"></i>';
            if (wordLower.includes('cry')) return '<i class="fa fa-sad-tear"></i>';
            if (wordLower.includes('sit')) return '<i class="fa fa-chair"></i>';
            if (wordLower.includes('stand')) return '<i class="fa fa-user"></i>';
            if (wordLower.includes('give')) return '<i class="fa fa-hand-holding-heart"></i>';
            if (wordLower.includes('like') || wordLower.includes('love')) return '<i class="fa fa-heart"></i>';
            if (wordLower.includes('go')) return '<i class="fa fa-arrow-right"></i>';
            if (wordLower.includes('come')) return '<i class="fa fa-arrow-left"></i>';
            if (wordLower.includes('open')) return '<i class="fa fa-door-open"></i>';
            if (wordLower.includes('close')) return '<i class="fa fa-door-closed"></i>';
            if (wordLower.includes('wash')) return '<i class="fa fa-hands-wash"></i>';
            if (wordLower.includes('help')) return '<i class="fa fa-hands-helping"></i>';
            
            // åœ°ç‚¹ç›¸å…³
            if (wordLower.includes('school')) return '<i class="fa fa-graduation-cap"></i>';
            if (wordLower.includes('hospital')) return '<i class="fa fa-hospital"></i>';
            if (wordLower.includes('restaurant')) return '<i class="fa fa-utensils"></i>';
            if (wordLower.includes('supermarket') || wordLower.includes('store') || wordLower.includes('shop')) return '<i class="fa fa-shopping-cart"></i>';
            if (wordLower.includes('library')) return '<i class="fa fa-book"></i>';
            if (wordLower.includes('museum')) return '<i class="fa fa-landmark"></i>';
            if (wordLower.includes('park')) return '<i class="fa fa-tree"></i>';
            if (wordLower.includes('beach')) return '<i class="fa fa-umbrella-beach"></i>';
            if (wordLower.includes('university') || wordLower.includes('college')) return '<i class="fa fa-university"></i>';
            if (wordLower.includes('office')) return '<i class="fa fa-building"></i>';
            if (wordLower.includes('factory')) return '<i class="fa fa-industry"></i>';
            if (wordLower.includes('bank')) return '<i class="fa fa-university"></i>';
            if (wordLower.includes('police')) return '<i class="fa fa-shield-alt"></i>';
            if (wordLower.includes('fire')) return '<i class="fa fa-fire"></i>';
            if (wordLower.includes('church')) return '<i class="fa fa-church"></i>';
            if (wordLower.includes('castle')) return '<i class="fa fa-chess-rook"></i>';
            if (wordLower.includes('bridge')) return '<i class="fa fa-route"></i>';
            if (wordLower.includes('tower')) return '<i class="fa fa-chess-king"></i>';
            if (wordLower.includes('zoo')) return '<i class="fa fa-horse"></i>';
            
            // äººç‰©ç›¸å…³
            if (wordLower.includes('friend')) return '<i class="fa fa-users"></i>';
            if (wordLower.includes('family')) return '<i class="fa fa-users"></i>';
            if (wordLower.includes('astronaut')) return '<i class="fa fa-user-astronaut"></i>';
            if (wordLower.includes('teacher')) return '<i class="fa fa-chalkboard-teacher"></i>';
            if (wordLower.includes('doctor')) return '<i class="fa fa-user-md"></i>';
            if (wordLower.includes('nurse')) return '<i class="fa fa-user-nurse"></i>';
            if (wordLower.includes('police') || wordLower.includes('policeman')) return '<i class="fa fa-user-shield"></i>';
            if (wordLower.includes('firefighter')) return '<i class="fa fa-fire-extinguisher"></i>';
            if (wordLower.includes('soldier')) return '<i class="fa fa-user-tie"></i>';
            if (wordLower.includes('pilot')) return '<i class="fa fa-user-tie"></i>';
            if (wordLower.includes('farmer')) return '<i class="fa fa-user"></i>';
            if (wordLower.includes('cook') || wordLower.includes('chef')) return '<i class="fa fa-user-chef"></i>';
            if (wordLower.includes('artist')) return '<i class="fa fa-palette"></i>';
            if (wordLower.includes('musician')) return '<i class="fa fa-music"></i>';
            if (wordLower.includes('scientist')) return '<i class="fa fa-flask"></i>';
            if (wordLower.includes('engineer')) return '<i class="fa fa-cogs"></i>';
            if (wordLower.includes('businessman')) return '<i class="fa fa-user-tie"></i>';
            if (wordLower.includes('student')) return '<i class="fa fa-user-graduate"></i>';
            if (wordLower.includes('baby')) return '<i class="fa fa-baby"></i>';
            if (wordLower.includes('child') || wordLower.includes('kid')) return '<i class="fa fa-child"></i>';
            if (wordLower.includes('boy')) return '<i class="fa fa-male"></i>';
            if (wordLower.includes('girl')) return '<i class="fa fa-female"></i>';
            if (wordLower.includes('man')) return '<i class="fa fa-male"></i>';
            if (wordLower.includes('woman')) return '<i class="fa fa-female"></i>';
            
            // å…¶ä»–é€šç”¨åŒ¹é…
            if (wordLower.includes('weather')) return '<i class="fa fa-cloud-sun"></i>';
            if (wordLower.includes('country') || wordLower.includes('world')) return '<i class="fa fa-globe"></i>';
            if (wordLower.includes('space')) return '<i class="fa fa-rocket"></i>';
            if (wordLower.includes('telescope')) return '<i class="fa fa-eye"></i>';
            if (wordLower.includes('microscope')) return '<i class="fa fa-search"></i>';
            if (wordLower.includes('music')) return '<i class="fa fa-music"></i>';
            if (wordLower.includes('game')) return '<i class="fa fa-gamepad"></i>';
            if (wordLower.includes('sport')) return '<i class="fa fa-futbol"></i>';
            if (wordLower.includes('dance')) return '<i class="fa fa-music"></i>';
            if (wordLower.includes('art')) return '<i class="fa fa-palette"></i>';
            if (wordLower.includes('movie')) return '<i class="fa fa-film"></i>';
            if (wordLower.includes('party')) return '<i class="fa fa-birthday-cake"></i>';
            if (wordLower.includes('birthday')) return '<i class="fa fa-birthday-cake"></i>';
            if (wordLower.includes('christmas')) return '<i class="fa fa-tree"></i>';
            if (wordLower.includes('halloween')) return '<i class="fa fa-ghost"></i>';
            if (wordLower.includes('love') || wordLower.includes('heart')) return '<i class="fa fa-heart"></i>';
            if (wordLower.includes('smile') || wordLower.includes('happy')) return '<i class="fa fa-smile"></i>';
            if (wordLower.includes('sad') || wordLower.includes('cry')) return '<i class="fa fa-frown"></i>';
            if (wordLower.includes('angry')) return '<i class="fa fa-angry"></i>';
            if (wordLower.includes('sleep')) return '<i class="fa fa-bed"></i>';
            if (wordLower.includes('eat') || wordLower.includes('food')) return '<i class="fa fa-utensils"></i>';
            if (wordLower.includes('drink')) return '<i class="fa fa-glass-whiskey"></i>';
            if (wordLower.includes('work')) return '<i class="fa fa-briefcase"></i>';
            if (wordLower.includes('study') || wordLower.includes('learn')) return '<i class="fa fa-book"></i>';
            if (wordLower.includes('play')) return '<i class="fa fa-gamepad"></i>';
            if (wordLower.includes('run')) return '<i class="fa fa-running"></i>';
            if (wordLower.includes('walk')) return '<i class="fa fa-walking"></i>';
            if (wordLower.includes('swim')) return '<i class="fa fa-swimming-pool"></i>';
            if (wordLower.includes('jump')) return '<i class="fa fa-arrow-up"></i>';
            if (wordLower.includes('dance')) return '<i class="fa fa-music"></i>';
            if (wordLower.includes('sing')) return '<i class="fa fa-microphone"></i>';
            if (wordLower.includes('read')) return '<i class="fa fa-book-open"></i>';
            if (wordLower.includes('write')) return '<i class="fa fa-pen"></i>';
            if (wordLower.includes('draw') || wordLower.includes('paint')) return '<i class="fa fa-palette"></i>';
            if (wordLower.includes('build') || wordLower.includes('make')) return '<i class="fa fa-hammer"></i>';
            if (wordLower.includes('clean')) return '<i class="fa fa-broom"></i>';
            if (wordLower.includes('wash')) return '<i class="fa fa-soap"></i>';
            if (wordLower.includes('cook')) return '<i class="fa fa-utensils"></i>';
            if (wordLower.includes('shop') || wordLower.includes('buy')) return '<i class="fa fa-shopping-cart"></i>';
            if (wordLower.includes('help')) return '<i class="fa fa-hands-helping"></i>';
            if (wordLower.includes('save')) return '<i class="fa fa-save"></i>';
            if (wordLower.includes('find') || wordLower.includes('search')) return '<i class="fa fa-search"></i>';
            if (wordLower.includes('open')) return '<i class="fa fa-door-open"></i>';
            if (wordLower.includes('close')) return '<i class="fa fa-door-closed"></i>';
            if (wordLower.includes('start') || wordLower.includes('begin')) return '<i class="fa fa-play"></i>';
            if (wordLower.includes('stop')) return '<i class="fa fa-stop"></i>';
            if (wordLower.includes('fast') || wordLower.includes('quick')) return '<i class="fa fa-tachometer-alt"></i>';
            if (wordLower.includes('slow')) return '<i class="fa fa-clock"></i>';
            if (wordLower.includes('big') || wordLower.includes('large')) return '<i class="fa fa-expand"></i>';
            if (wordLower.includes('small') || wordLower.includes('tiny')) return '<i class="fa fa-compress"></i>';
            if (wordLower.includes('hot')) return '<i class="fa fa-fire"></i>';
            if (wordLower.includes('cold')) return '<i class="fa fa-snowflake"></i>';
            if (wordLower.includes('new')) return '<i class="fa fa-star"></i>';
            if (wordLower.includes('old')) return '<i class="fa fa-clock"></i>';
            if (wordLower.includes('good') || wordLower.includes('great')) return '<i class="fa fa-thumbs-up"></i>';
            if (wordLower.includes('bad')) return '<i class="fa fa-thumbs-down"></i>';
            if (wordLower.includes('beautiful') || wordLower.includes('pretty')) return '<i class="fa fa-star"></i>';
            if (wordLower.includes('ugly')) return '<i class="fa fa-times"></i>';
            if (wordLower.includes('strong')) return '<i class="fa fa-dumbbell"></i>';
            if (wordLower.includes('weak')) return '<i class="fa fa-heart-broken"></i>';
            if (wordLower.includes('rich')) return '<i class="fa fa-dollar-sign"></i>';
            if (wordLower.includes('poor')) return '<i class="fa fa-heart-broken"></i>';
            if (wordLower.includes('smart') || wordLower.includes('clever')) return '<i class="fa fa-brain"></i>';
            if (wordLower.includes('stupid') || wordLower.includes('dumb')) return '<i class="fa fa-question"></i>';
            if (wordLower.includes('brave')) return '<i class="fa fa-shield-alt"></i>';
            if (wordLower.includes('scared') || wordLower.includes('afraid')) return '<i class="fa fa-ghost"></i>';
            if (wordLower.includes('funny')) return '<i class="fa fa-laugh"></i>';
            if (wordLower.includes('boring')) return '<i class="fa fa-sleep"></i>';
            if (wordLower.includes('exciting')) return '<i class="fa fa-star"></i>';
            if (wordLower.includes('dangerous')) return '<i class="fa fa-exclamation-triangle"></i>';
            if (wordLower.includes('safe')) return '<i class="fa fa-shield-alt"></i>';
            if (wordLower.includes('free')) return '<i class="fa fa-unlock"></i>';
            if (wordLower.includes('busy')) return '<i class="fa fa-calendar"></i>';
            if (wordLower.includes('quiet')) return '<i class="fa fa-volume-mute"></i>';
            if (wordLower.includes('loud') || wordLower.includes('noisy')) return '<i class="fa fa-volume-up"></i>';
            if (wordLower.includes('bright')) return '<i class="fa fa-lightbulb"></i>';
            if (wordLower.includes('dark')) return '<i class="fa fa-moon"></i>';
            if (wordLower.includes('color') || wordLower.includes('colour')) return '<i class="fa fa-palette"></i>';
            if (wordLower.includes('red')) return '<i class="fa fa-circle" style="color: red;"></i>';
            if (wordLower.includes('blue')) return '<i class="fa fa-circle" style="color: blue;"></i>';
            if (wordLower.includes('green')) return '<i class="fa fa-circle" style="color: green;"></i>';
            if (wordLower.includes('yellow')) return '<i class="fa fa-circle" style="color: yellow;"></i>';
            if (wordLower.includes('orange')) return '<i class="fa fa-circle" style="color: orange;"></i>';
            if (wordLower.includes('purple')) return '<i class="fa fa-circle" style="color: purple;"></i>';
            if (wordLower.includes('pink')) return '<i class="fa fa-circle" style="color: pink;"></i>';
            if (wordLower.includes('brown')) return '<i class="fa fa-circle" style="color: brown;"></i>';
            if (wordLower.includes('black')) return '<i class="fa fa-circle" style="color: black;"></i>';
            if (wordLower.includes('white')) return '<i class="fa fa-circle" style="color: white;"></i>';
            if (wordLower.includes('gray') || wordLower.includes('grey')) return '<i class="fa fa-circle" style="color: gray;"></i>';
            
            // å¦‚æœæ²¡æœ‰åŒ¹é…åˆ°ä»»ä½•å›¾æ ‡ï¼Œè¿”å›é»˜è®¤å›¾æ ‡
            return '<i class="fa fa-question"></i>';
        }

        // è·å–DOMå…ƒç´ 
        const startScreen = document.getElementById('start-screen');
        const gameScreen = document.getElementById('game-screen');
        const startBtn = document.getElementById('start-btn');
        const difficultyBtns = document.querySelectorAll('.difficulty-btn');
        const levelDisplay = document.getElementById('level-display');
        const scoreDisplay = document.getElementById('score-display');
        const comboDisplay = document.getElementById('combo-display');
        const countdownEl = document.getElementById('countdown');
        const imagePlaceholder = document.getElementById('image-placeholder');
        const wordPlaceholder = document.getElementById('word-placeholder');
        const hintText = document.getElementById('hint-text');
        const bubblesContainer = document.getElementById('bubbles-container');

        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', () => {
            initButtons();
        });

        // åˆå§‹åŒ–æŒ‰é’®
        function initButtons() {
            // éš¾åº¦é€‰æ‹©æŒ‰é’®
            difficultyBtns.forEach(btn => {
                btn.addEventListener('click', () => {
                    difficultyBtns.forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    gameState.currentDifficulty = btn.dataset.difficulty;
                });
            });

            // å¼€å§‹æŒ‰é’®
            startBtn.addEventListener('click', startGame);
        }

        // å¼€å§‹æ¸¸æˆ
        function startGame() {
            gameState.level = 1;
            gameState.score = 0;
            gameState.combo = 0;
            gameState.isGameActive = true;
            gameState.timeLeft = 25;
            gameState.currentDifficulty = gameState.currentDifficulty || 'easy';
            clearInterval(gameState.timer); clearInterval(gameState.spawnTimer);
            startScreen.classList.add('hidden');
            gameScreen.classList.remove('hidden');
            nextLevel();
        }

        // ç”Ÿæˆå…³å¡ç›®æ ‡
        function generateTargets(difficulty) {
            const alphabet = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'.split('');
            const pick = (n) => shuffleArray(alphabet).slice(0, n);
            if (difficulty === 'easy') {
                const count = gameState.level <= 3 ? 1 : 2; // å‰å‡ å…³1ä¸ªï¼Œå†åˆ°2ä¸ª
                const letters = pick(count);
                return letters.map(l => ({ letter: l, need: 3, got: 0 }));
            }
            if (difficulty === 'medium') {
                const count = gameState.level <= 3 ? 3 : 4;
                const letters = pick(count);
                return letters.map(l => ({ letter: l, need: 3, got: 0 }));
            }
            // hardï¼šä»å•è¯æŒ‘å­—æ¯é›†åˆ
            const words = wordDatabase.easy; // ç”¨æ˜“è¯åº“ï¼Œé•¿åº¦é€‚ä¸­
            const randomWord = words[Math.floor(Math.random() * words.length)].word.replace(/\s+/g,'');
            const set = Array.from(new Set(randomWord.split('')));
            return set.slice(0, 5).map(l => ({ letter: l.toUpperCase(), need: 2, got: 0 }));
        }

        // è¿›å…¥ä¸‹ä¸€å…³
        function nextLevel() {
            if (!gameState.isGameActive) return;
            gameState.targets = generateTargets(gameState.currentDifficulty);
            gameState.timeLeft = gameState.currentDifficulty === 'easy' ? 25 : (gameState.currentDifficulty === 'medium' ? 28 : 32);
            gameState.spawnIntervalMs = gameState.currentDifficulty === 'easy' ? 1200 : (gameState.currentDifficulty === 'medium' ? 1000 : 900);
            clearInterval(gameState.timer); clearInterval(gameState.spawnTimer);

            // UI
            const desc = gameState.currentDifficulty === 'hard' ? 'ğŸ¯ ç›®æ ‡ï¼šæˆ³ä¸­è¯¥å•è¯æ‰€å«çš„å­—æ¯' : 'ğŸ¯ ç›®æ ‡ï¼šæˆ³ä¸­æŒ‡å®šå­—æ¯è¾¾åˆ°æ•°é‡';
            hintText.textContent = desc;
            imagePlaceholder.innerHTML = '<i class="fa fa-font"></i>';
            updateTargetsDisplay();
            startTimer();
            startSpawning();
            updateGameDisplay();
        }

        // è¿ç»­ç”Ÿæˆæ³¡æ³¡ï¼ˆä»å·¦å³é£å…¥ï¼‰
        function startSpawning() {
            bubblesContainer.innerHTML = '';
            gameState.spawnTimer = setInterval(() => {
                if (!gameState.isGameActive) return;
                if (bubblesContainer.childElementCount >= gameState.maxBubbles) return;
                const bubble = document.createElement('div');
                bubble.className = 'bubble';
                const letter = pickLetterForSpawn();
                bubble.textContent = letter;
                bubble.dataset.letter = letter;
                // éšæœºé¡¶éƒ¨ä½ç½®
                const h = bubblesContainer.clientHeight;
                const top = Math.random() * (h - 80) + 10;
                bubble.style.top = top + 'px';
                // éšæœºæ–¹å‘
                const fromLeft = Math.random() < 0.5;
                bubble.classList.add(fromLeft ? 'from-left' : 'from-right');
                const duration = 7 + Math.random() * 3; // 7-10s æ›´æ…¢
                bubble.style.animationDuration = duration + 's';
                bubble.addEventListener('animationend', () => bubble.remove());
                bubble.addEventListener('pointerdown', handleBubbleClick, { passive: false });
                bubblesContainer.appendChild(bubble);
            }, gameState.spawnIntervalMs);
        }

        function pickLetterForSpawn() {
            const alphabet = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
            // 65% æ¦‚ç‡ç”Ÿæˆç›®æ ‡å­—æ¯ï¼Œä¿è¯å¯å®Œæˆ
            if (Math.random() < 0.65 && gameState.targets.length > 0) {
                // åœ¨ä»æœªè¾¾æ ‡çš„ç›®æ ‡é‡ŒæŒ‘
                const remain = gameState.targets.filter(t => t.got < t.need);
                if (remain.length > 0) return remain[Math.floor(Math.random() * remain.length)].letter;
                return gameState.targets[Math.floor(Math.random() * gameState.targets.length)].letter;
            }
            return alphabet[Math.floor(Math.random() * alphabet.length)];
        }

        // ç”Ÿæˆé¢å¤–å­—æ¯
        function generateExtraLetters(word) {
            const alphabet = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
            const extraCount = Math.max(3, word.length);
            const extraLetters = [];
            
            for (let i = 0; i < extraCount; i++) {
                let randomLetter;
                do {
                    randomLetter = alphabet[Math.floor(Math.random() * alphabet.length)];
                } while (word.includes(randomLetter) || extraLetters.includes(randomLetter));
                extraLetters.push(randomLetter);
            }
            
            return extraLetters;
        }

        // å¤„ç†æ³¡æ³¡ç‚¹å‡»
        function handleBubbleClick(event) {
            try { if (event) { event.preventDefault(); event.stopPropagation(); } } catch(_) {}
            if (!gameState.isGameActive) return;
            
            const letter = this.dataset.letter;
            const target = gameState.targets.find(t => t.letter === letter);
            const isCorrect = !!target && target.got < target.need;
            const bubbleEl = this;
            if (isCorrect) {
                target.got += 1;
                this.classList.add('correct');
                gameState.combo++;
                gameState.score += 50 + gameState.combo * 10;
                updateTargetsDisplay();
                if (gameState.targets.every(t => t.got >= t.need)) {
                    levelComplete();
                }
            } else {
                gameState.combo = 0;
                gameState.score = Math.max(0, gameState.score - 20);
            }
            
            // ç‚¹å‡»åï¼šå‘½ä¸­â†’åŸåœ°æ¶ˆå¤±ï¼ˆå¹¶é”ä½åœè¡¨ï¼‰ï¼›é”™ä¸­â†’ä¸ç§»é™¤æ°”æ³¡ï¼Œä»…å¼¹å‡ºæç¤ºï¼ˆä¿æŒåŸè½¨è¿¹ï¼‰
            if (isCorrect) {
                // å‘½ä¸­ï¼šå…ˆåœè¡¨é”ä½ï¼Œå†ç§»é™¤
                try {
                    bubbleEl.classList.remove('from-left','from-right');
                    const r0 = bubbleEl.getBoundingClientRect();
                    const pr0 = bubblesContainer.getBoundingClientRect();
                    bubbleEl.style.position = 'absolute';
                    bubbleEl.style.left = (r0.left - pr0.left) + 'px';
                    bubbleEl.style.top = (r0.top - pr0.top) + 'px';
                    bubbleEl.style.right = 'auto';
                    bubbleEl.style.animation = 'none';
                    bubbleEl.style.animationPlayState = 'paused';
                    bubbleEl.style.transition = 'none';
                    bubbleEl.style.transform = 'none';
                    void bubbleEl.offsetWidth;
                } catch(_) {}
                // æœ€ç®€è¡Œä¸ºï¼šå‘½ä¸­å³åˆ»æ¶ˆå¤±
                bubbleEl.remove();
            } else {
                // é”™ä¸­ï¼šä¸ç§»é™¤æ°”æ³¡ï¼Œé¡¶éƒ¨æ˜¾ç¤ºæ–‡æ¡ˆ
                try {
                    const r = bubbleEl.getBoundingClientRect();
                    const tip = document.createElement('div');
                    tip.className = 'toast-tip';
                    tip.textContent = 'æˆ³é”™å•¦ï¼Œè¯·æ‰¾æŒ‡å®šå­—æ¯';
                    tip.style.left = (r.left + r.width/2) + 'px';
                    tip.style.top = (r.top - 24) + 'px';
                    document.body.appendChild(tip);
                    setTimeout(() => tip.remove(), 900);
                } catch(_) {}
            }
            
            updateGameDisplay();
        }

        function updateTargetsDisplay() {
            const el = document.getElementById('targets-display');
            const targets = gameState.targets || [];
            const hintEl = document.getElementById('hint-text');
            if (targets.length === 1) {
                const t = targets[0];
                const left = Math.max(0, t.need - t.got);
                if (hintEl) hintEl.textContent = `ğŸ¯ ç›®æ ‡ï¼šè¯·æˆ³ä¸­ ${left} ä¸ª å­—æ¯ ${t.letter}`;
                const done = t.got >= t.need;
                el.className = 'text-3xl md:text-4xl font-extrabold ' + (done ? 'text-green-700' : 'text-amber-800') + ' bg-gradient-to-r from-yellow-100 to-orange-100 px-8 py-6 rounded-3xl shadow-xl border-4 border-yellow-300 inline-block';
                el.innerHTML = `<span class=\"inline-flex items-center justify-center bg-white/95 px-8 py-4 rounded-2xl shadow\">${t.letter}\u00A0 ${t.got}/${t.need}</span>`;
                return;
            }
            if (hintEl) hintEl.textContent = 'ğŸ¯ ç›®æ ‡ï¼šæˆ³ä¸­æŒ‡å®šå­—æ¯è¾¾åˆ°æ•°é‡';
            el.className = 'text-base md:text-lg font-bold text-gray-800 bg-gradient-to-r from-yellow-100 to-orange-100 px-6 py-3 rounded-2xl shadow-lg border-2 border-yellow-300 inline-block';
            const html = targets.map(t => {
                const left = Math.max(0, t.need - t.got);
                const done = left === 0;
                return `<span class=\"inline-flex items-center justify-center rounded-lg px-2 py-1 mr-2 mb-2 border ${done ? 'bg-green-100 border-green-300 text-green-700' : 'bg-white border-yellow-300 text-yellow-700'}\">${t.letter}\u00A0 ${t.got}/${t.need}</span>`;
            }).join('');
            el.innerHTML = html;
        }

        function levelComplete() {
            clearInterval(gameState.spawnTimer);
            showEndDialog(true);
            try { if (window.achievements) window.achievements.unlockAchievement('wb_first_round'); } catch(_) {}
        }

        // å¼€å§‹è®¡æ—¶å™¨
        function startTimer() {
            if (gameState.timer) {
                clearInterval(gameState.timer);
            }
            
            gameState.timer = setInterval(() => {
                gameState.timeLeft--;
                countdownEl.textContent = gameState.timeLeft;
                
                if (gameState.timeLeft <= 0) {
                    timeUp();
                }
            }, 1000);
        }

        // æ—¶é—´åˆ°
        function timeUp() {
            clearInterval(gameState.timer);
            clearInterval(gameState.spawnTimer);
            gameState.combo = 0;
            showEndDialog(false);
        }

        // ç»“æŸå¼¹çª—
        function showEndDialog(success){
            const overlay = document.createElement('div');
            overlay.className = 'fixed inset-0 bg-black/30 flex items-center justify-center z-50';
            const card = document.createElement('div');
            card.className = 'bg-white rounded-2xl shadow-2xl p-6 w-80 text-center';
            card.innerHTML = `
                <div class="text-4xl mb-2">${success ? 'ğŸ‰' : 'â°'}</div>
                <div class="text-lg font-bold mb-1">${success ? 'å®Œæˆç›®æ ‡ï¼' : 'æ—¶é—´åˆ°'}</div>
                <div class="text-sm text-gray-600 mb-4">${success ? 'å‡†å¤‡å¥½è¿›å…¥ä¸‹ä¸€å…³äº†å—ï¼Ÿ' : 'è¦å†è¯•ä¸€å…³è¿˜æ˜¯è¿”å›é¦–é¡µï¼Ÿ'}</div>
                <div class="flex gap-3 justify-center">
                    <button id="dlg-retry" class="px-4 py-2 rounded-lg bg-primary text-white">${success ? 'ä¸‹ä¸€å…³' : 'å†è¯•ä¸€å…³'}</button>
                    <button id="dlg-home" class="px-4 py-2 rounded-lg bg-gray-200">è¿”å›é¦–é¡µ</button>
                </div>
            `;
            overlay.appendChild(card);
            document.body.appendChild(overlay);
            document.getElementById('dlg-home').onclick = function(){ window.location.href = 'index.html'; };
            document.getElementById('dlg-retry').onclick = function(){
                overlay.remove();
                if (!gameState.isGameActive) return;
                if (success) { gameState.level += 1; }
                nextLevel();
            };
        }

        // æ›´æ–°æ¸¸æˆæ˜¾ç¤º
        function updateGameDisplay() {
            levelDisplay.textContent = gameState.level;
            scoreDisplay.textContent = gameState.score;
            comboDisplay.textContent = gameState.combo;
        }



        // å·¥å…·å‡½æ•°ï¼šæ‰“ä¹±æ•°ç»„
        function shuffleArray(array) {
            const newArray = [...array];
            for (let i = newArray.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
            }
            return newArray;
        }

        // åˆå§‹åŒ–æŒ‰é’®æ ·å¼
        document.addEventListener('DOMContentLoaded', () => {
            const style = document.createElement('style');
            style.textContent = `
                .difficulty-btn {
                    display: flex;
                    flex-direction: column;
                    align-items: center;
                    gap: 0.25rem;
                    padding: 1rem;
                    border-radius: 1rem;
                    border: 2px solid #e5e7eb;
                    background: white;
                    cursor: pointer;
                    transition: all 0.3s;
                }
                .difficulty-btn:hover {
                    transform: translateY(-2px);
                    box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1);
                }
                .difficulty-btn.active {
                    border-color: #4F46E5;
                    background: linear-gradient(135deg, #4F46E5, #10B981);
                    color: white;
                }
            `;
            document.head.appendChild(style);
        });
    </script>
</body>
</html> 