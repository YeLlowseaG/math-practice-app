<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Â≠óÊØçË∑≥Ë∑≥‰πê - ÈùíËõôË∑≥Ë∑ÉÂ§ßÂÜíÈô©</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    
    <!-- ÈÖçÁΩÆTailwindËá™ÂÆö‰πâÈ¢úËâ≤ÂíåÂ≠ó‰Ωì -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#4F46E5',
                        secondary: '#10B981',
                        accent: '#F59E0B',
                        danger: '#EF4444',
                        neutral: '#F7FFF7',
                        text: '#1F2937',
                        frog: '#22C55E',
                        lily: '#86EFAC'
                    },
                    fontFamily: {
                        kids: ['"Comic Sans MS"', '"Marker Felt"', 'Arial', 'sans-serif']
                    }
                }
            }
        }
    </script>
    
    <style type="text/tailwindcss">
        @layer utilities {
            .text-shadow {
                text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
            }
            .bounce-light {
                animation: bounce-light 0.5s ease infinite alternate;
            }
            
            /* Ê∏∏ÊàèÁîªÂ∏ÉÊ†∑Âºè */
            #game-canvas {
                background: linear-gradient(180deg, #87CEEB 0%, #40B7E0 50%, #4682B4 100%);
                border: 4px solid #2563EB;
                border-radius: 20px;
                position: relative;
                overflow: hidden;
                box-shadow: 0 0 30px rgba(37, 99, 235, 0.3);
            }
            
            /* Ê∑ªÂä†Ê∞¥Èù¢Ê≥¢Á∫πÊïàÊûú */
            #game-canvas::before {
                content: '';
                position: absolute;
                bottom: 0;
                left: 0;
                right: 0;
                height: 100px;
                background: repeating-linear-gradient(
                    90deg,
                    rgba(255, 255, 255, 0.1) 0px,
                    rgba(255, 255, 255, 0.2) 50px,
                    rgba(255, 255, 255, 0.1) 100px
                );
                animation: waterRipple 4s linear infinite;
                z-index: 1;
            }
            
            @keyframes waterRipple {
                0% { transform: translateX(-100px); }
                100% { transform: translateX(100px); }
            }
            
            /* ÈùíËõôÊ†∑Âºè - Êõ¥Á≤æÁæéÁöÑËÆæËÆ° */
            .frog {
                position: absolute;
                width: 80px;
                height: 80px;
                cursor: pointer;
                transition: transform 0.1s ease;
                z-index: 10;
                animation: frogIdle 3s ease-in-out infinite;
            }
            
            .frog::before {
                content: '';
                position: absolute;
                width: 100%;
                height: 100%;
                background: radial-gradient(ellipse at 30% 30%, #34D399, #22C55E, #16A34A);
                border-radius: 50% 50% 50% 50% / 60% 60% 40% 40%;
                box-shadow: 
                    0 8px 16px rgba(22, 163, 74, 0.3),
                    inset 0 2px 8px rgba(255, 255, 255, 0.3),
                    inset 0 -2px 8px rgba(0, 0, 0, 0.2);
                z-index: 1;
            }
            
            /* ÈùíËõôÁúºÁùõ */
            .frog::after {
                content: 'üëÄ';
                position: absolute;
                top: 15%;
                left: 50%;
                transform: translateX(-50%);
                font-size: 1.5rem;
                z-index: 3;
                animation: eyeBlink 4s infinite;
            }
            
            .frog .frog-mouth {
                position: absolute;
                bottom: 25%;
                left: 50%;
                transform: translateX(-50%);
                width: 30px;
                height: 8px;
                background: #1F2937;
                border-radius: 50px;
                z-index: 2;
            }
            
            /* ÈùíËõôÂæÖÊú∫Âä®Áîª */
            @keyframes frogIdle {
                0%, 100% { transform: scale(1) rotate(0deg); }
                25% { transform: scale(1.05) rotate(1deg); }
                75% { transform: scale(0.95) rotate(-1deg); }
            }
            
            @keyframes eyeBlink {
                0%, 90%, 100% { opacity: 1; }
                 95% { opacity: 0.3; }
            }
            
            .frog:hover {
                transform: scale(1.15);
            }
            
            .frog.jumping {
                animation: frogJump 0.8s ease-out;
            }
            
            @keyframes frogJump {
                0% { 
                    transform: translateY(0) scale(1) rotate(0deg); 
                }
                30% { 
                    transform: translateY(-120px) scale(1.3) rotate(-10deg); 
                }
                70% { 
                    transform: translateY(-100px) scale(1.2) rotate(5deg); 
                }
                100% { 
                    transform: translateY(0) scale(1) rotate(0deg); 
                }
            }
            
            /* Ëç∑Âè∂Ê†∑Âºè - Êõ¥ÁæéËßÇÁöÑËÆæËÆ° */
            .lily-pad {
                position: absolute;
                width: 90px;
                height: 90px;
                display: flex;
                align-items: center;
                justify-content: center;
                animation: lilyFall 4s linear forwards;
                cursor: pointer;
                filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.2));
            }
            
            .lily-pad::before {
                content: '';
                position: absolute;
                width: 100%;
                height: 100%;
                background: radial-gradient(ellipse at 35% 25%, #D1FAE5, #86EFAC, #22C55E, #16A34A);
                border-radius: 50% 50% 50% 50% / 60% 60% 40% 40%;
                box-shadow: 
                    inset 0 2px 6px rgba(255, 255, 255, 0.4),
                    inset 0 -2px 6px rgba(0, 0, 0, 0.1);
                z-index: 1;
            }
            
            /* Ëç∑Âè∂Á∫πË∑Ø */
            .lily-pad::after {
                content: '';
                position: absolute;
                top: 20%;
                left: 45%;
                width: 2px;
                height: 60%;
                background: rgba(22, 163, 74, 0.6);
                border-radius: 2px;
                transform: rotate(-5deg);
                z-index: 2;
                box-shadow: 
                    4px 0 0 rgba(22, 163, 74, 0.3),
                    -4px 0 0 rgba(22, 163, 74, 0.3),
                    8px 0 0 rgba(22, 163, 74, 0.2),
                    -8px 0 0 rgba(22, 163, 74, 0.2);
            }
            
            .lily-pad.golden {
                animation: lilyFall 4s linear forwards, goldenGlow 2s ease-in-out infinite;
            }
            
            .lily-pad.golden::before {
                background: radial-gradient(ellipse at 35% 25%, #FEF3C7, #FBBF24, #F59E0B, #D97706);
            }
            
            @keyframes goldenGlow {
                0%, 100% { 
                    filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.2)) 
                           drop-shadow(0 0 15px rgba(251, 191, 36, 0.4)); 
                }
                50% { 
                    filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.2)) 
                           drop-shadow(0 0 25px rgba(251, 191, 36, 0.8)); 
                }
            }
            
            .lily-letter {
                font-size: 2rem;
                font-weight: bold;
                color: white;
                text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
                z-index: 2;
            }
            
            @keyframes lilyFall {
                0% { 
                    transform: translateY(-100px) rotate(0deg);
                    opacity: 0;
                }
                10% {
                    opacity: 1;
                }
                90% {
                    opacity: 1;
                }
                100% { 
                    transform: translateY(600px) rotate(360deg);
                    opacity: 0;
                }
            }
            
            /* Ê∞¥Ëä±ÊïàÊûú */
            .splash {
                position: absolute;
                width: 40px;
                height: 40px;
                border-radius: 50%;
                animation: splashEffect 0.5s ease-out forwards;
                pointer-events: none;
            }
            
            @keyframes splashEffect {
                0% { 
                    transform: scale(0);
                    opacity: 1;
                }
                50% {
                    transform: scale(1.5);
                    opacity: 0.7;
                }
                100% { 
                    transform: scale(2);
                    opacity: 0;
                }
            }
            
            /* ÂæóÂàÜÂä®Áîª */
            .score-popup {
                position: absolute;
                font-size: 2rem;
                font-weight: bold;
                color: #22C55E;
                text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
                animation: scoreFloat 1s ease-out forwards;
                pointer-events: none;
                z-index: 20;
            }
            
            @keyframes scoreFloat {
                0% { 
                    transform: translateY(0) scale(1);
                    opacity: 1;
                }
                100% { 
                    transform: translateY(-50px) scale(1.2);
                    opacity: 0;
                }
            }
            
            /* ÊéßÂà∂ËØ¥Êòé */
            .controls {
                background: rgba(255, 255, 255, 0.9);
                backdrop-filter: blur(10px);
                border-radius: 15px;
                padding: 15px;
                margin: 10px;
            }
            
            @keyframes bounce-light {
                from { transform: translateY(0); }
                to { transform: translateY(-5px); }
            }
        }
    </style>
</head>
<body class="bg-gradient-to-br from-blue-50 via-green-50 to-blue-100 min-h-screen font-kids text-text">
    
    <!-- ÂºÄÂßãÁïåÈù¢ -->
    <div id="start-screen" class="flex flex-col items-center justify-center min-h-screen p-4 relative">
        <!-- ËøîÂõûÈ¶ñÈ°µÊåâÈíÆ -->
        <button onclick="window.location.href='index.html'" class="absolute top-4 right-4 bg-white/90 backdrop-blur-sm px-4 py-2 rounded-full shadow-lg transition-all duration-300 hover:scale-105 active:scale-95 text-sm font-bold text-gray-600 hover:text-gray-800 z-40">
            <i class="fa fa-home mr-2"></i>È¶ñÈ°µ
        </button>
        
        <div class="text-center w-full max-w-md mx-auto bg-white rounded-3xl shadow-2xl p-8 transform transition-all duration-500">
            <div class="flex justify-center mb-6">
                <div class="w-20 h-20 bg-gradient-to-br from-frog to-green-600 rounded-full flex items-center justify-center text-white text-3xl shadow-lg relative overflow-hidden">
                    üê∏
                    <div class="absolute inset-0 bg-white opacity-20 rounded-full animate-ping"></div>
                </div>
            </div>
            
            <h1 class="text-3xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-frog via-blue-500 to-green-600 mb-4">Â≠óÊØçË∑≥Ë∑≥‰πê</h1>
            
            <div class="bg-green-50 rounded-2xl p-4 mb-6">
                <p class="text-green-800 text-sm font-medium mb-2">
                    <i class="fa fa-gamepad mr-2 text-blue-500"></i>Ê∏∏ÊàèÁé©Ê≥ï
                </p>
                <p class="text-green-700 text-sm">
                    üê∏ ÁßªÂä®ÈùíËõôÊé•‰ΩèÊ≠£Á°ÆÁöÑÂ≠óÊØçËç∑Âè∂<br>
                    ‚¨ÖÔ∏è‚û°Ô∏è Â∑¶Âè≥ÊãñÊãΩÊàñÁÇπÂáªÁßªÂä®<br>
                    üåø Ëç∑Âè∂‰ºö‰ªéÂ§©Á©∫Êéâ‰∏ãÊù•
                </p>
            </div>
            
            <div class="grid grid-cols-2 gap-4 text-sm text-gray-600 mb-6">
                <div class="flex items-center">
                    <i class="fa fa-graduation-cap text-blue-500 mr-2"></i>
                    <span>Â≠¶‰π†Â≠óÊØç</span>
                </div>
                <div class="flex items-center">
                    <i class="fa fa-heart text-pink-500 mr-2"></i>
                    <span>ÈÄÇÂêà4-8Â≤Å</span>
                </div>
                <div class="flex items-center">
                    <i class="fa fa-trophy text-yellow-500 mr-2"></i>
                    <span>26ÂÖ≥ÊåëÊàò</span>
                </div>
                <div class="flex items-center">
                    <i class="fa fa-star text-purple-500 mr-2"></i>
                    <span>Ë∂ÖÂ•ΩÁé©</span>
                </div>
            </div>
            
            <button onclick="startGame()" class="w-full bg-gradient-to-r from-frog to-green-600 hover:from-green-600 hover:to-frog text-white font-bold py-4 px-6 rounded-2xl text-lg shadow-lg transform transition-all duration-300 hover:scale-105 active:scale-95">
                ÂºÄÂßãË∑≥Ë∑≥‰πê <i class="fa fa-play ml-2"></i>
            </button>
        </div>
        
        <!-- Ë£ÖÈ•∞ÂÖÉÁ¥† -->
        <div class="absolute top-10 left-10 text-4xl text-frog/30 hidden md:block bounce-light">
            üê∏
        </div>
        <div class="absolute bottom-10 right-10 text-4xl text-blue-400/30 hidden md:block bounce-light" style="animation-delay: 0.3s">
            üåä
        </div>
    </div>

    <!-- Ê∏∏ÊàèÁïåÈù¢ -->
    <div id="game-screen" class="hidden min-h-screen p-4">
        <!-- È°∂ÈÉ®‰ø°ÊÅØÊ†è -->
        <div class="flex justify-between items-center mb-4">
            <button onclick="pauseGame()" class="bg-white/90 backdrop-blur-sm px-4 py-2 rounded-full shadow-lg transition-all duration-300 hover:scale-105 active:scale-95 text-sm font-bold text-gray-600">
                <i class="fa fa-pause mr-2"></i>ÊöÇÂÅú
            </button>
            
            <div class="flex items-center space-x-3">
                <div class="bg-gradient-to-r from-blue-500 to-blue-600 text-white px-4 py-2 rounded-full shadow-lg font-bold">
                    <i class="fa fa-font mr-1"></i>
                    Êâæ <span id="target-letter">A</span>
                </div>
                <div class="bg-gradient-to-r from-frog to-green-600 text-white px-4 py-2 rounded-full shadow-lg font-bold">
                    <i class="fa fa-star mr-1"></i>
                    <span id="score">0</span>
                </div>
                <div class="bg-gradient-to-r from-yellow-500 to-orange-600 text-white px-4 py-2 rounded-full shadow-lg font-bold">
                    <i class="fa fa-fire mr-1"></i>
                    <span id="combo">0</span>ËøûÂáª
                </div>
                <div class="bg-gradient-to-r from-purple-500 to-purple-600 text-white px-4 py-2 rounded-full shadow-lg font-bold">
                    ÂÖ≥Âç° <span id="level">1</span>
                </div>
            </div>
        </div>

        <!-- Ê∏∏ÊàèÁîªÂ∏É -->
        <div class="max-w-4xl mx-auto">
            <div id="game-canvas" style="width: 100%; height: 500px; max-width: 800px; margin: 0 auto;">
                <!-- ÈùíËõô -->
                <div id="frog" class="frog" style="bottom: 10px; left: 50%; transform: translateX(-50%);">
                    <div class="frog-mouth"></div>
                </div>
                
                <!-- Ëç∑Âè∂ÂÆπÂô® -->
                <div id="lily-container"></div>
                
                <!-- ÁâπÊïàÂÆπÂô® -->
                <div id="effects-container"></div>
            </div>
            
            <!-- ÊéßÂà∂ËØ¥Êòé -->
            <div class="controls text-center text-sm text-gray-600 mt-4">
                <p><i class="fa fa-hand-pointer-o mr-2"></i>ÁÇπÂáªÂ±èÂπï‰∏§‰æßÁßªÂä®ÈùíËõôÔºåÊàñÁõ¥Êé•ÊãñÊãΩÈùíËõô</p>
                <p class="mt-1">Êé•‰ΩèÂ≠óÊØç <span id="current-target" class="font-bold text-blue-600">A</span> ÁöÑËç∑Âè∂ÔºÅ</p>
            </div>
        </div>
    </div>

    <!-- ÊöÇÂÅúÁïåÈù¢ -->
    <div id="pause-screen" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
        <div class="bg-white rounded-3xl shadow-2xl p-8 text-center max-w-sm mx-auto">
            <h3 class="text-2xl font-bold mb-6">Ê∏∏ÊàèÊöÇÂÅú</h3>
            <div class="space-y-4">
                <button onclick="resumeGame()" class="w-full bg-gradient-to-r from-frog to-green-600 text-white font-bold py-3 px-6 rounded-2xl transition-all duration-300 hover:scale-105 active:scale-95">
                    <i class="fa fa-play mr-2"></i>ÁªßÁª≠Ê∏∏Êàè
                </button>
                <button onclick="restartGame()" class="w-full bg-gradient-to-r from-accent to-orange-600 text-white font-bold py-3 px-6 rounded-2xl transition-all duration-300 hover:scale-105 active:scale-95">
                    <i class="fa fa-refresh mr-2"></i>ÈáçÊñ∞ÂºÄÂßã
                </button>
                <button onclick="window.location.href='index.html'" class="w-full bg-gradient-to-r from-gray-500 to-gray-600 text-white font-bold py-3 px-6 rounded-2xl transition-all duration-300 hover:scale-105 active:scale-95">
                    <i class="fa fa-home mr-2"></i>ËøîÂõûÈ¶ñÈ°µ
                </button>
            </div>
        </div>
    </div>

    <!-- ÂÆåÊàêÁïåÈù¢ -->
    <div id="complete-screen" class="hidden flex flex-col items-center justify-center min-h-screen p-4">
        <div class="bg-white rounded-3xl shadow-2xl p-8 text-center max-w-md mx-auto">
            <div class="text-6xl mb-4">üéâ</div>
            <h2 class="text-2xl font-bold mb-4 text-green-600">ÊÅ≠ÂñúÈÄöÂÖ≥ÔºÅ</h2>
            <div class="bg-green-50 rounded-2xl p-6 mb-6">
                <p class="text-green-800 text-lg mb-4">üéâ ‰Ω†Â≠¶‰ºö‰∫ÜÊâÄÊúâ26‰∏™Â≠óÊØçÔºÅ</p>
                <div class="grid grid-cols-2 gap-4 text-center">
                    <div>
                        <div class="text-3xl font-bold text-green-600" id="final-score">0</div>
                        <p class="text-sm text-green-600">ÊÄªÂæóÂàÜ</p>
                    </div>
                    <div>
                        <div class="text-3xl font-bold text-orange-600" id="final-combo">0</div>
                        <p class="text-sm text-orange-600">ÊúÄÈ´òËøûÂáª</p>
                    </div>
                </div>
                <div class="mt-4 text-center">
                    <p class="text-sm text-green-700" id="final-accuracy">ÂáÜÁ°ÆÁéá: 100%</p>
                </div>
            </div>
            <div class="flex space-x-4">
                <button onclick="restartGame()" class="flex-1 bg-gradient-to-r from-frog to-green-600 text-white font-bold py-3 px-6 rounded-2xl transition-all duration-300 hover:scale-105 active:scale-95">
                    <i class="fa fa-refresh mr-2"></i>ÂÜçÁé©‰∏ÄÊ¨°
                </button>
                <button onclick="window.location.href='index.html'" class="flex-1 bg-gradient-to-r from-gray-500 to-gray-600 text-white font-bold py-3 px-6 rounded-2xl transition-all duration-300 hover:scale-105 active:scale-95">
                    <i class="fa fa-home mr-2"></i>ËøîÂõûÈ¶ñÈ°µ
                </button>
            </div>
        </div>
    </div>

    <script>
        // Ê∏∏ÊàèÁä∂ÊÄÅ
        const letters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'.split('');
        let currentLevel = 0;
        let targetLetter = 'A';
        let score = 0;
        let gameRunning = false;
        let frogPosition = 50; // ÁôæÂàÜÊØî‰ΩçÁΩÆ
        let liliesSpawned = 0;
        let liliesCaught = 0;
        let spawnTimer = null;
        let combo = 0; // ËøûÂáªÊï∞
        let maxCombo = 0;
        let wrongCatches = 0; // ÈîôËØØÊé•‰ΩèÁöÑÊ¨°Êï∞
        let perfectStreak = 0; // ÂÆåÁæéËøûÂáª
        let powerUpActive = false;
        
        // DOMÂÖÉÁ¥†
        const frog = document.getElementById('frog');
        const gameCanvas = document.getElementById('game-canvas');
        const lilyContainer = document.getElementById('lily-container');
        const effectsContainer = document.getElementById('effects-container');
        
        // ÂàùÂßãÂåñÊ∏∏Êàè
        function initGame() {
            currentLevel = 0;
            targetLetter = letters[currentLevel];
            score = 0;
            liliesSpawned = 0;
            liliesCaught = 0;
            combo = 0;
            maxCombo = 0;
            wrongCatches = 0;
            perfectStreak = 0;
            powerUpActive = false;
            updateUI();
            setupControls();
        }
        
        // Êõ¥Êñ∞UIÊòæÁ§∫
        function updateUI() {
            document.getElementById('target-letter').textContent = targetLetter;
            document.getElementById('current-target').textContent = targetLetter;
            document.getElementById('score').textContent = score;
            document.getElementById('level').textContent = currentLevel + 1;
            document.getElementById('combo').textContent = combo;
            
            // ËøûÂáªÊïàÊûú
            const comboElement = document.getElementById('combo').parentElement;
            if (combo >= 5) {
                comboElement.style.animation = 'pulse 0.5s ease-in-out infinite alternate';
            } else {
                comboElement.style.animation = '';
            }
        }
        
        // ËÆæÁΩÆÊéßÂà∂
        function setupControls() {
            // Èº†Ê†á/Ëß¶Êë∏ÊéßÂà∂
            gameCanvas.addEventListener('click', handleCanvasClick);
            frog.addEventListener('mousedown', startDragFrog);
            frog.addEventListener('touchstart', startDragFrog, {passive: false});
            
            // ÈîÆÁõòÊéßÂà∂
            document.addEventListener('keydown', handleKeyboard);
        }
        
        // Â§ÑÁêÜÁîªÂ∏ÉÁÇπÂáª
        function handleCanvasClick(e) {
            if (!gameRunning) return;
            
            const rect = gameCanvas.getBoundingClientRect();
            const clickX = ((e.clientX - rect.left) / rect.width) * 100;
            
            // ÁßªÂä®ÈùíËõôÂà∞ÁÇπÂáª‰ΩçÁΩÆ
            moveFrogTo(clickX);
        }
        
        // ÁßªÂä®ÈùíËõô
        function moveFrogTo(percentage) {
            frogPosition = Math.max(10, Math.min(90, percentage));
            frog.style.left = frogPosition + '%';
            frog.style.transform = 'translateX(-50%)';
        }
        
        // ÈùíËõôÊãñÊãΩ
        function startDragFrog(e) {
            if (!gameRunning) return;
            
            e.preventDefault();
            
            function handleDrag(e) {
                const rect = gameCanvas.getBoundingClientRect();
                const clientX = e.clientX || (e.touches && e.touches[0].clientX);
                if (clientX) {
                    const dragX = ((clientX - rect.left) / rect.width) * 100;
                    moveFrogTo(dragX);
                }
            }
            
            function stopDrag() {
                document.removeEventListener('mousemove', handleDrag);
                document.removeEventListener('mouseup', stopDrag);
                document.removeEventListener('touchmove', handleDrag);
                document.removeEventListener('touchend', stopDrag);
            }
            
            document.addEventListener('mousemove', handleDrag);
            document.addEventListener('mouseup', stopDrag);
            document.addEventListener('touchmove', handleDrag, {passive: false});
            document.addEventListener('touchend', stopDrag);
        }
        
        // ÈîÆÁõòÊéßÂà∂
        function handleKeyboard(e) {
            if (!gameRunning) return;
            
            switch(e.key) {
                case 'ArrowLeft':
                case 'a':
                case 'A':
                    moveFrogTo(frogPosition - 10);
                    break;
                case 'ArrowRight':
                case 'd':
                case 'D':
                    moveFrogTo(frogPosition + 10);
                    break;
            }
        }
        
        // ÁîüÊàêËç∑Âè∂
        function spawnLily() {
            if (!gameRunning) return;
            
            const lily = document.createElement('div');
            lily.className = 'lily-pad';
            
            // ÈöèÊú∫‰ΩçÁΩÆ
            const xPosition = Math.random() * 85 + 5; // 5% Âà∞ 90%
            lily.style.left = xPosition + '%';
            lily.style.top = '-100px';
            
            // Â≠óÊØçÁîüÊàêÈÄªËæëÔºàÊ†πÊçÆËøûÂáªË∞ÉÊï¥Ê¶ÇÁéáÔºâ
            let targetProbability = 0.7;
            if (combo >= 10) {
                targetProbability = 0.85; // È´òËøûÂáªÊó∂Êõ¥Â§öÁõÆÊ†áÂ≠óÊØç
            } else if (combo >= 5) {
                targetProbability = 0.8;
            }
            
            const isTarget = Math.random() < targetProbability;
            const letterToShow = isTarget ? targetLetter : letters[Math.floor(Math.random() * letters.length)];
            
            // 5%Ê¶ÇÁéáÁîüÊàêÈáëËâ≤Ëç∑Âè∂ÔºàÂèåÂÄçÂàÜÊï∞Ôºâ
            const isGolden = Math.random() < 0.05 && isTarget;
            if (isGolden) {
                lily.classList.add('golden');
            }
            
            lily.innerHTML = `<span class="lily-letter" style="z-index: 3; position: relative;">${letterToShow}</span>`;
            lily.dataset.letter = letterToShow;
            lily.dataset.isTarget = isTarget;
            lily.dataset.isGolden = isGolden;
            
            lilyContainer.appendChild(lily);
            liliesSpawned++;
            
            // Ê£ÄÊµãÁ¢∞Êíû
            setTimeout(() => {
                checkCollision(lily);
            }, 3800); // Ëç∑Âè∂ËêΩÂà∞ÈùíËõô‰ΩçÁΩÆÁöÑÊó∂Èó¥
            
            // Ê∏ÖÁêÜËç∑Âè∂
            setTimeout(() => {
                if (lily.parentNode) {
                    lily.remove();
                }
            }, 4000);
        }
        
        // Ê£ÄÊµãÁ¢∞Êíû
        function checkCollision(lily) {
            if (!lily.parentNode || !gameRunning) return;
            
            const lilyRect = lily.getBoundingClientRect();
            const frogRect = frog.getBoundingClientRect();
            const canvasRect = gameCanvas.getBoundingClientRect();
            
            // ËÆ°ÁÆóÁõ∏ÂØπ‰∫éÁîªÂ∏ÉÁöÑ‰ΩçÁΩÆ
            const lilyX = ((lilyRect.left + lilyRect.width/2) - canvasRect.left) / canvasRect.width * 100;
            const frogX = frogPosition;
            
            // Ê£ÄÊµãÊ∞¥Âπ≥Á¢∞ÊíûÔºàËÄÉËôëÈùíËõôÂíåËç∑Âè∂ÁöÑÂÆΩÂ∫¶Ôºâ
            const distance = Math.abs(lilyX - frogX);
            
            if (distance < 12) { // Á¢∞ÊíûÊ£ÄÊµãËåÉÂõ¥
                handleCatch(lily);
            }
        }
        
        // Â§ÑÁêÜÊé•‰ΩèËç∑Âè∂
        function handleCatch(lily) {
            const letter = lily.dataset.letter;
            const isTarget = lily.dataset.isTarget === 'true';
            
            // ÁßªÈô§Ëç∑Âè∂
            lily.remove();
            
            // ÈùíËõôË∑≥Ë∑ÉÂä®Áîª
            frog.classList.add('jumping');
            setTimeout(() => {
                frog.classList.remove('jumping');
            }, 600);
            
            if (isTarget && letter === targetLetter) {
                // Êé•‰ΩèÊ≠£Á°ÆÂ≠óÊØç
                handleCorrectCatch(lily);
            } else {
                // Êé•‰ΩèÈîôËØØÂ≠óÊØç
                handleWrongCatch(lily);
            }
        }
        
        // Êé•‰ΩèÊ≠£Á°ÆÂ≠óÊØç
        function handleCorrectCatch(lily) {
            liliesCaught++;
            combo++;
            perfectStreak++;
            maxCombo = Math.max(maxCombo, combo);
            
            const isGolden = lily.dataset.isGolden === 'true';
            
            // ËÆ°ÁÆóÂæóÂàÜÔºàÂü∫Á°ÄÂàÜ10ÂàÜÔºåËøûÂáªÂíåÈáëËâ≤Âä†ÊàêÔºâ
            let points = 10;
            if (isGolden) {
                points *= 2; // ÈáëËâ≤Ëç∑Âè∂ÂèåÂÄçÂàÜÊï∞
            }
            if (combo >= 5) {
                points += Math.floor(combo / 5) * 5; // ËøûÂáªÂä†Êàê
            }
            
            score += points;
            
            // ÂàõÂª∫ÂæóÂàÜÂä®Áîª
            let popupText = `+${points}`;
            let popupColor = '#22C55E';
            
            if (isGolden) {
                popupText += ' üåü';
                popupColor = '#F59E0B';
            }
            if (combo >= 10) {
                popupText += ` ${combo}ËøûÂáª!`;
                popupColor = '#EF4444';
            }
            
            createScorePopup(popupText, popupColor);
            
            // ÂàõÂª∫ÁâπÊïà
            if (isGolden) {
                createGoldenSplash(frog.offsetLeft + 40, frog.offsetTop);
            } else {
                createSplash(frog.offsetLeft + 40, frog.offsetTop, '#22C55E');
            }
            
            // ËøûÂáªÁâπÊïà
            if (combo % 5 === 0 && combo >= 5) {
                createComboEffect();
            }
            
            updateUI();
            
            // Ê£ÄÊü•ÊòØÂê¶ÂèØ‰ª•ËøõÂÖ•‰∏ã‰∏ÄÂÖ≥
            if (liliesCaught >= 3) { // ÊØèÂÖ≥Êé•‰Ωè3‰∏™Ê≠£Á°ÆÂ≠óÊØç
                nextLevel();
            }
        }
        
        // Êé•‰ΩèÈîôËØØÂ≠óÊØç
        function handleWrongCatch(lily) {
            wrongCatches++;
            
            // ÈáçÁΩÆËøûÂáª
            if (combo > 0) {
                createScorePopup(`ËøûÂáª‰∏≠Êñ≠! (${combo})`, '#EF4444');
                combo = 0;
                perfectStreak = 0;
            }
            
            // ÂàõÂª∫Â§±Ë¥•Ê∞¥Ëä±
            createSplash(frog.offsetLeft + 40, frog.offsetTop, '#EF4444');
            
            updateUI();
        }
        
        // ÂàõÂª∫ÂæóÂàÜÂºπÁ™ó
        function createScorePopup(text, color) {
            const popup = document.createElement('div');
            popup.className = 'score-popup';
            popup.textContent = text;
            popup.style.color = color;
            popup.style.left = frog.offsetLeft + 30 + 'px';
            popup.style.top = frog.offsetTop - 20 + 'px';
            
            effectsContainer.appendChild(popup);
            
            setTimeout(() => {
                popup.remove();
            }, 1000);
        }
        
        // ÂàõÂª∫Ê∞¥Ëä±ÊïàÊûú
        function createSplash(x, y, color) {
            const splash = document.createElement('div');
            splash.className = 'splash';
            splash.style.backgroundColor = color;
            splash.style.left = x + 'px';
            splash.style.top = y + 'px';
            
            effectsContainer.appendChild(splash);
            
            setTimeout(() => {
                splash.remove();
            }, 500);
        }
        
        // ÂàõÂª∫ÈáëËâ≤Ê∞¥Ëä±ÊïàÊûú
        function createGoldenSplash(x, y) {
            for (let i = 0; i < 6; i++) {
                const particle = document.createElement('div');
                particle.className = 'splash';
                particle.style.background = 'radial-gradient(circle, #FCD34D, #F59E0B)';
                particle.style.width = '15px';
                particle.style.height = '15px';
                particle.style.left = (x + (Math.random() - 0.5) * 40) + 'px';
                particle.style.top = (y + (Math.random() - 0.5) * 40) + 'px';
                particle.style.animationDelay = (i * 0.1) + 's';
                
                effectsContainer.appendChild(particle);
                
                setTimeout(() => {
                    particle.remove();
                }, 800);
            }
        }
        
        // ÂàõÂª∫ËøûÂáªÁâπÊïà
        function createComboEffect() {
            const comboText = document.createElement('div');
            comboText.className = 'score-popup';
            comboText.textContent = `üî• ${combo} ËøûÂáª! üî•`;
            comboText.style.color = '#F59E0B';
            comboText.style.fontSize = '3rem';
            comboText.style.fontWeight = 'bold';
            comboText.style.left = (gameCanvas.offsetWidth / 2 - 100) + 'px';
            comboText.style.top = (gameCanvas.offsetHeight / 3) + 'px';
            comboText.style.textShadow = '3px 3px 6px rgba(0,0,0,0.5)';
            
            effectsContainer.appendChild(comboText);
            
            setTimeout(() => {
                comboText.remove();
            }, 1500);
        }
        
        // ‰∏ã‰∏ÄÂÖ≥
        function nextLevel() {
            currentLevel++;
            
            if (currentLevel >= letters.length) {
                // Ê∏∏ÊàèÂÆåÊàê
                gameComplete();
                return;
            }
            
            targetLetter = letters[currentLevel];
            liliesCaught = 0;
            liliesSpawned = 0;
            updateUI();
            
            // ÁÆÄÁü≠ÂÅúÈ°øÊòæÁ§∫Êñ∞Â≠óÊØç
            gameRunning = false;
            clearInterval(spawnTimer);
            
            setTimeout(() => {
                gameRunning = true;
                startSpawning();
            }, 2000);
        }
        
        // ÂºÄÂßãÁîüÊàêËç∑Âè∂
        function startSpawning() {
            spawnTimer = setInterval(() => {
                spawnLily();
            }, 1500 - Math.min(currentLevel * 50, 800)); // ÈöæÂ∫¶ÈÄíÂ¢û
        }
        
        // ÂºÄÂßãÊ∏∏Êàè
        function startGame() {
            document.getElementById('start-screen').classList.add('hidden');
            document.getElementById('game-screen').classList.remove('hidden');
            
            initGame();
            gameRunning = true;
            startSpawning();
        }
        
        // ÊöÇÂÅúÊ∏∏Êàè
        function pauseGame() {
            gameRunning = false;
            clearInterval(spawnTimer);
            document.getElementById('pause-screen').classList.remove('hidden');
        }
        
        // ÁªßÁª≠Ê∏∏Êàè
        function resumeGame() {
            document.getElementById('pause-screen').classList.add('hidden');
            gameRunning = true;
            startSpawning();
        }
        
        // ÈáçÊñ∞ÂºÄÂßã
        function restartGame() {
            // Ê∏ÖÁêÜ
            clearInterval(spawnTimer);
            lilyContainer.innerHTML = '';
            effectsContainer.innerHTML = '';
            
            // ÈöêËóèÊâÄÊúâÁïåÈù¢
            document.getElementById('start-screen').classList.add('hidden');
            document.getElementById('game-screen').classList.add('hidden');
            document.getElementById('pause-screen').classList.add('hidden');
            document.getElementById('complete-screen').classList.add('hidden');
            
            // ÈáçÁΩÆÈùíËõô‰ΩçÁΩÆ
            frogPosition = 50;
            moveFrogTo(50);
            
            // ÈáçÊñ∞ÂºÄÂßã
            setTimeout(() => {
                startGame();
            }, 300);
        }
        
        // Ê∏∏ÊàèÂÆåÊàê
        function gameComplete() {
            gameRunning = false;
            clearInterval(spawnTimer);
            
            // ËÆ°ÁÆóÂáÜÁ°ÆÁéá
            const totalCatches = liliesCaught + wrongCatches;
            const accuracy = totalCatches > 0 ? Math.round((liliesCaught / totalCatches) * 100) : 100;
            
            document.getElementById('final-score').textContent = score;
            document.getElementById('final-combo').textContent = maxCombo;
            document.getElementById('final-accuracy').textContent = `ÂáÜÁ°ÆÁéá: ${accuracy}%`;
            
            document.getElementById('game-screen').classList.add('hidden');
            document.getElementById('complete-screen').classList.remove('hidden');
        }
        
        // È°µÈù¢Âä†ËΩΩÂÆåÊàê
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Â≠óÊØçË∑≥Ë∑≥‰πêÂàùÂßãÂåñÂÆåÊàê');
        });
    </script>
</body>
</html>