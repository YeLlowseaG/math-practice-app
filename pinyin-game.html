<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>æ‹¼éŸ³å°è¾¾äºº - å¬è¯»éŸ³é€‰æ‹¼éŸ³</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    
    <!-- é…ç½®Tailwindè‡ªå®šä¹‰é¢œè‰²å’Œå­—ä½“ -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#FF6B9D',
                        secondary: '#45B7D1',
                        accent: '#FFA726',
                        success: '#66BB6A',
                        danger: '#EF5350',
                        neutral: '#F7FFF7',
                        text: '#2D3748'
                    },
                    fontFamily: {
                        kids: ['"Comic Sans MS"', '"Marker Felt"', 'Arial', 'sans-serif']
                    }
                }
            }
        }
    </script>
    
    <style type="text/tailwindcss">
        @layer utilities {
            .text-shadow {
                text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
            }
            .bounce-light {
                animation: bounce-light 0.5s ease infinite alternate;
            }
            .pulse-slow {
                animation: pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite;
            }
            .scale-hover {
                transition: transform 0.2s;
            }
            .scale-hover:hover {
                transform: scale(1.05);
            }
            .correct-animation {
                animation: correct 0.6s ease-in-out;
            }
            .wrong-animation {
                animation: wrong 0.6s ease-in-out;
            }
            .level-complete {
                animation: levelComplete 1s ease-in-out;
            }
            .float-animation {
                animation: float 3s ease-in-out infinite;
            }
            .sound-wave {
                animation: soundWave 1.5s ease-in-out infinite;
            }
            @keyframes bounce-light {
                from { transform: translateY(0); }
                to { transform: translateY(-5px); }
            }
            @keyframes correct {
                0% { transform: scale(1); background-color: #66BB6A; }
                50% { transform: scale(1.1); background-color: #81C784; }
                100% { transform: scale(1); background-color: #66BB6A; }
            }
            @keyframes wrong {
                0% { transform: translateX(0); background-color: #EF5350; }
                25% { transform: translateX(-5px); background-color: #E57373; }
                75% { transform: translateX(5px); background-color: #E57373; }
                100% { transform: translateX(0); background-color: #EF5350; }
            }
            @keyframes levelComplete {
                0% { transform: scale(1) rotate(0deg); }
                25% { transform: scale(1.2) rotate(5deg); }
                75% { transform: scale(1.2) rotate(-5deg); }
                100% { transform: scale(1) rotate(0deg); }
            }
            @keyframes float {
                0%, 100% { transform: translateY(0px); }
                50% { transform: translateY(-10px); }
            }
            @keyframes soundWave {
                0%, 100% { transform: scale(1); opacity: 1; }
                50% { transform: scale(1.2); opacity: 0.7; }
            }
            .button-press {
                animation: button-press 0.2s ease-in-out;
            }
            @keyframes button-press {
                0% { transform: scale(1); }
                50% { transform: scale(0.95); }
                100% { transform: scale(1); }
            }
            
            /* ç§»åŠ¨ç«¯ä¼˜åŒ– */
            @media (max-width: 768px) {
                .option-btn {
                    min-height: 60px;
                    font-size: 1.1rem;
                    padding: 14px 20px;
                    margin: 6px;
                    word-wrap: break-word;
                    white-space: normal;
                    line-height: 1.2;
                }
                .float-animation {
                    animation: none;
                }
                #options-container {
                    gap: 12px;
                    max-width: 100%;
                }
            }
            
            @media (max-width: 480px) {
                .option-btn {
                    min-height: 54px;
                    font-size: 1rem;
                    padding: 12px 16px;
                    margin: 4px;
                }
                #options-container {
                    grid-template-columns: 1fr 1fr;
                    gap: 8px;
                    padding: 0 10px;
                }
            }
        }
    </style>
</head>
<body class="bg-gradient-to-br from-pink-50 via-blue-50 to-orange-50 min-h-screen font-kids text-text overflow-hidden">
    
    <!-- å¼€å§‹ç•Œé¢ -->
    <div id="start-screen" class="flex flex-col items-center justify-center h-screen p-6 relative">
        <!-- è¿”å›é¦–é¡µæŒ‰é’® -->
        <button onclick="window.location.href='index.html'" class="absolute top-4 right-4 bg-white/90 backdrop-blur-sm px-4 py-2 rounded-full shadow-lg transition-all duration-300 hover:scale-105 active:scale-95 text-sm font-bold text-gray-600 hover:text-gray-800 z-40">
            <i class="fa fa-home mr-2"></i>é¦–é¡µ
        </button>
        <div class="text-center max-w-md mx-auto bg-white rounded-2xl shadow-xl p-6 transform transition-all duration-500">
            <h1 class="text-2xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-primary to-secondary mb-3">æ‹¼éŸ³å°è¾¾äºº</h1>
            <p class="text-sm mb-4 text-gray-600">å¬è¯»éŸ³é€‰æ‹¼éŸ³<br>å¿«ä¹å­¦æ‹¼éŸ³ï¼Œè½»æ¾è¯†æ±‰å­—ï¼</p>
            
            <div class="flex justify-center mb-6">
                <div class="w-20 h-20 bg-gradient-to-br from-primary to-secondary rounded-full flex items-center justify-center text-white text-2xl shadow-lg relative overflow-hidden float-animation">
                    <i class="fa fa-volume-up"></i>
                    <div class="absolute inset-0 bg-white opacity-20 rounded-full animate-ping"></div>
                </div>
            </div>
            
            <!-- å­¦ä¹ æ¨¡å¼é€‰æ‹© -->
            <div class="mb-5">
                <h3 class="text-base font-bold text-gray-700 mb-2">é€‰æ‹©å­¦ä¹ å†…å®¹</h3>
                
                <!-- åŸºç¡€å­¦ä¹  -->
                <div class="mb-3">
                    <h4 class="text-sm font-bold text-gray-600 mb-2 flex items-center justify-center">
                        <i class="fa fa-graduation-cap mr-1"></i>åŸºç¡€å­¦ä¹ 
                    </h4>
                    <div class="grid grid-cols-2 gap-2">
                        <button class="mode-btn bg-blue-500 text-white px-3 py-2 rounded-xl text-sm font-bold shadow-md transform transition-all duration-300 hover:scale-105 active:scale-95" data-mode="consonants">
                            <i class="fa fa-volume-up mr-1"></i>å£°æ¯å­¦ä¹ <br><span class="text-xs opacity-80">b p m f d t...</span>
                        </button>
                        <button class="mode-btn bg-purple-500 text-white px-3 py-2 rounded-xl text-sm font-bold shadow-md transform transition-all duration-300 hover:scale-105 active:scale-95" data-mode="vowels">
                            <i class="fa fa-music mr-1"></i>éŸµæ¯å­¦ä¹ <br><span class="text-xs opacity-80">a o e i u Ã¼...</span>
                        </button>
                    </div>
                </div>

                <!-- ç»¼åˆç»ƒä¹  -->
                <div class="mb-3">
                    <h4 class="text-sm font-bold text-gray-600 mb-2 flex items-center justify-center">
                        <i class="fa fa-gamepad mr-1"></i>ç»¼åˆç»ƒä¹ 
                    </h4>
                    <div class="grid grid-cols-2 gap-1">
                        <button class="difficulty-btn bg-green-500 text-white px-2 py-2 rounded-xl text-xs font-bold shadow-md transform transition-all duration-300 hover:scale-105 active:scale-95" data-level="beginner">
                            ğŸŒŸå…¥é—¨<br><span class="text-xs opacity-80">å•å­—æ‹¼éŸ³</span>
                        </button>
                        <button class="difficulty-btn bg-blue-500 text-white px-2 py-2 rounded-xl text-xs font-bold shadow-md transform transition-all duration-300 hover:scale-105 active:scale-95" data-level="basic">
                            ğŸŒŸåŸºç¡€<br><span class="text-xs opacity-80">åŒå­—è¯æ±‡</span>
                        </button>
                        <button class="difficulty-btn bg-orange-500 text-white px-2 py-2 rounded-xl text-xs font-bold shadow-md transform transition-all duration-300 hover:scale-105 active:scale-95" data-level="advanced">
                            ğŸŒŸè¿›é˜¶<br><span class="text-xs opacity-80">ä¸‰å­—è¯æ±‡</span>
                        </button>
                        <button class="difficulty-btn bg-red-500 text-white px-2 py-2 rounded-xl text-xs font-bold shadow-md transform transition-all duration-300 hover:scale-105 active:scale-95" data-level="expert">
                            ğŸŒŸæŒ‘æˆ˜<br><span class="text-xs opacity-80">å¤æ‚éŸ³èŠ‚</span>
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- å€’è®¡æ—¶å¼€å…³ -->
            <div class="mb-4 flex items-center justify-center gap-3 bg-gray-50 rounded-xl p-3">
                <i class="fa fa-clock-o text-gray-600 text-sm"></i>
                <span class="text-gray-700 font-medium text-sm">å€’è®¡æ—¶æ¨¡å¼</span>
                <label class="relative inline-flex items-center cursor-pointer">
                    <input type="checkbox" id="timer-toggle" class="sr-only peer" checked>
                    <div class="w-9 h-5 bg-gray-200 peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-blue-600"></div>
                </label>
                <span class="text-xs text-gray-500" id="timer-description">æ ¹æ®éš¾åº¦é™æ—¶</span>
            </div>
            
            <button id="start-btn" class="bg-primary hover:bg-pink-400 text-white font-bold py-3 px-6 rounded-xl text-lg shadow-md transform transition-all duration-300 hover:scale-105 active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed" disabled>
                å¼€å§‹å­¦ä¹  <i class="fa fa-play ml-1"></i>
            </button>
            
            <div class="mt-4 text-xs text-gray-500">
                <p>é€‚åˆå¹´é¾„ï¼š5-8å²</p>
                <p>ç›®æ ‡ï¼šé€šè¿‡å¬åŠ›è®­ç»ƒæŒæ¡æ‹¼éŸ³ï¼</p>
            </div>
        </div>
        
        <!-- è£…é¥°å…ƒç´  -->
        <div class="absolute top-10 left-10 text-5xl text-primary/30">
            <i class="fa fa-music bounce-light"></i>
        </div>
        <div class="absolute bottom-10 right-10 text-5xl text-secondary/30">
            <i class="fa fa-headphones bounce-light" style="animation-delay: 0.3s"></i>
        </div>
    </div>

    <!-- æ¸¸æˆç•Œé¢ -->
    <div id="game-screen" class="hidden h-screen flex flex-col">
        <!-- é¡¶éƒ¨ä¿¡æ¯æ  -->
        <div class="flex justify-between items-center p-3 bg-white/80 backdrop-blur-sm shadow-md">
            <!-- å·¦ä¾§ä¿¡æ¯ -->
            <div class="flex items-center gap-3">
                <!-- è¿”å›é¦–é¡µæŒ‰é’® -->
                <button onclick="window.location.href='index.html'" class="bg-white/90 backdrop-blur-sm px-3 py-2 rounded-full shadow-md transition-all duration-300 hover:scale-105 active:scale-95 text-sm font-bold text-gray-600 hover:text-gray-800">
                    <i class="fa fa-home mr-1"></i><span class="hidden sm:inline">é¦–é¡µ</span>
                </button>
                <div class="bg-primary px-4 py-2 rounded-full text-white font-bold shadow-md">
                    <span>å…³å¡ </span><span id="level-display">1</span>
                </div>
                <div class="bg-secondary px-4 py-2 rounded-full text-white font-bold shadow-md">
                    <span>è¿å‡» </span><span id="combo-display">0</span>
                </div>
            </div>
            
            <!-- ä¸­é—´è®¡æ—¶å™¨ -->
            <div id="timer" class="bg-accent text-white px-6 py-3 rounded-full shadow-md">
                <i class="fa fa-clock-o mr-2"></i>
                <span id="countdown" class="text-xl font-bold">å€’è®¡æ—¶ 10.0</span>
            </div>
            
            <!-- å³ä¾§åˆ†æ•° -->
            <div class="bg-gradient-to-r from-purple-500 to-pink-500 px-4 py-2 rounded-full text-white font-bold shadow-md">
                <i class="fa fa-star mr-2"></i>
                <span id="score-display">0</span>
            </div>
        </div>

        <!-- ä¸»æ¸¸æˆåŒºåŸŸ -->
        <div class="flex-1 flex flex-col items-center justify-center p-6 relative">
            <!-- æ±‰å­—æ˜¾ç¤ºåŒºåŸŸ -->
            <div class="mb-8">
                <div class="bg-white rounded-3xl shadow-2xl p-8 text-center min-w-[200px]">
                    <p class="text-gray-500 text-lg mb-2">è¯·é€‰æ‹©æ­£ç¡®çš„æ‹¼éŸ³</p>
                    <p class="text-6xl font-bold text-text mb-4" id="character-display">é©¬</p>
                    <button id="play-sound-btn" class="bg-primary text-white px-6 py-3 rounded-full font-bold shadow-lg transform transition-all duration-300 hover:scale-105 active:scale-95 sound-wave">
                        <i class="fa fa-volume-up mr-2"></i><span id="play-btn-text">æ’­æ”¾è¯»éŸ³</span>
                    </button>
                </div>
            </div>

            <!-- é€‰é¡¹åŒºåŸŸ -->
            <div class="grid grid-cols-2 gap-4 max-w-md mx-auto" id="options-container">
                <!-- é€‰é¡¹æŒ‰é’®å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
            </div>

            <!-- åé¦ˆä¿¡æ¯ - ç§»åŠ¨åˆ°é¡¶éƒ¨æ›´æ˜æ˜¾çš„ä½ç½® -->
            <div id="feedback" class="fixed top-20 left-0 right-0 z-50 flex items-center justify-center pointer-events-none">
                <div id="feedback-content" class="hidden bg-white rounded-2xl shadow-2xl p-4 border-4 border-primary/20 max-w-sm mx-auto pointer-events-auto">
                    <p id="feedback-text" class="text-xl font-bold mb-2 text-center"></p>
                    <div id="feedback-detail" class="text-sm text-gray-600 text-center"></div>
                </div>
            </div>
        </div>

        <!-- è¿›åº¦æ¡ -->
        <div class="px-6 pb-4">
            <div class="bg-gray-200 rounded-full h-3 overflow-hidden">
                <div id="progress-bar" class="bg-gradient-to-r from-primary to-secondary h-full rounded-full transition-all duration-500" style="width: 0%"></div>
            </div>
            <p class="text-center text-sm text-gray-600 mt-2">
                <span id="current-question">1</span> / <span id="total-questions">10</span>
            </p>
        </div>
    </div>

    <!-- ç»“æœç•Œé¢ -->
    <div id="result-screen" class="hidden h-screen flex flex-col items-center justify-center p-6 relative">
        <div class="text-center max-w-md mx-auto bg-white rounded-3xl shadow-2xl p-8">
            <div class="mb-6">
                <div id="result-icon" class="w-24 h-24 mx-auto rounded-full flex items-center justify-center text-4xl text-white shadow-lg mb-4">
                    <i id="result-emoji" class="fa fa-star"></i>
                </div>
                <h2 id="result-title" class="text-3xl font-bold mb-2">æ­å–œå®Œæˆï¼</h2>
                <p id="result-subtitle" class="text-lg text-gray-600 mb-4">ä½ çœŸæ£’ï¼</p>
            </div>
            
            <!-- æˆç»©ç»Ÿè®¡ -->
            <div class="grid grid-cols-2 gap-4 mb-6">
                <div class="bg-primary/10 rounded-2xl p-4">
                    <p class="text-primary font-bold text-2xl" id="final-score">0</p>
                    <p class="text-sm text-gray-600">æ€»åˆ†æ•°</p>
                </div>
                <div class="bg-secondary/10 rounded-2xl p-4">
                    <p class="text-secondary font-bold text-2xl" id="accuracy-rate">0%</p>
                    <p class="text-sm text-gray-600">å‡†ç¡®ç‡</p>
                </div>
                <div class="bg-success/10 rounded-2xl p-4">
                    <p class="text-success font-bold text-2xl" id="max-combo">0</p>
                    <p class="text-sm text-gray-600">æœ€é«˜è¿å‡»</p>
                </div>
                <div class="bg-accent/10 rounded-2xl p-4">
                    <p class="text-accent font-bold text-2xl" id="level-reached">1</p>
                    <p class="text-sm text-gray-600">è¾¾åˆ°å…³å¡</p>
                </div>
            </div>
            
            <!-- æ“ä½œæŒ‰é’® -->
            <div class="flex gap-4">
                <button id="restart-btn" class="flex-1 bg-primary hover:bg-pink-400 text-white font-bold py-3 px-6 rounded-full shadow-lg transform transition-all duration-300 hover:scale-105 active:scale-95">
                    <i class="fa fa-refresh mr-2"></i>å†è¯•ä¸€æ¬¡
                </button>
                <button onclick="window.location.href='index.html'" class="flex-1 bg-gray-500 hover:bg-gray-400 text-white font-bold py-3 px-6 rounded-full shadow-lg transform transition-all duration-300 hover:scale-105 active:scale-95">
                    <i class="fa fa-home mr-2"></i>è¿”å›é¦–é¡µ
                </button>
            </div>
        </div>
    </div>

    <script>
        // æ¸¸æˆçŠ¶æ€å˜é‡
        let currentLevel = '';
        let isTimerEnabled = true;
        let gameActive = false;
        let currentQuestion = 0;
        let totalQuestions = 10;
        let score = 0;
        let combo = 0;
        let maxCombo = 0;
        let correctAnswers = 0;
        let currentCharacter = '';
        let currentPinyin = '';
        let timerInterval = null;
        let timeLeft = 0;

        // DOMå…ƒç´ 
        const startScreen = document.getElementById('start-screen');
        const gameScreen = document.getElementById('game-screen');
        const resultScreen = document.getElementById('result-screen');
        const difficultyBtns = document.querySelectorAll('.difficulty-btn');
        const startBtn = document.getElementById('start-btn');
        const timerToggle = document.getElementById('timer-toggle');
        const timerDescription = document.getElementById('timer-description');
        const levelDisplay = document.getElementById('level-display');
        const comboDisplay = document.getElementById('combo-display');
        const scoreDisplay = document.getElementById('score-display');
        const countdown = document.getElementById('countdown');
        const characterDisplay = document.getElementById('character-display');
        const playSoundBtn = document.getElementById('play-sound-btn');
        const optionsContainer = document.getElementById('options-container');
        const feedbackContent = document.getElementById('feedback-content');
        const feedbackText = document.getElementById('feedback-text');
        const feedbackDetail = document.getElementById('feedback-detail');
        const progressBar = document.getElementById('progress-bar');
        const currentQuestionSpan = document.getElementById('current-question');
        const totalQuestionsSpan = document.getElementById('total-questions');
        const restartBtn = document.getElementById('restart-btn');

        // åˆ†åœºæ™¯æ‹¼éŸ³æ•°æ®åº“ - 4ä¸ªéš¾åº¦ç­‰çº§
        const pinyinData = {
            // ğŸŒŸ å…¥é—¨ - å•å­—æ‹¼éŸ³
            beginner: {
                name: 'å…¥é—¨çº§',
                description: 'å•å­—æ‹¼éŸ³ç»ƒä¹ ',
                timeLimit: 20,
                scenarios: {
                    animals: {
                        name: 'åŠ¨ç‰©å›­',
                        icon: 'ğŸ¾',
                        data: [
                            { char: 'é©¬', pinyin: 'mÇ', options: ['mÇ', 'mÄ', 'mÃ¡'], emoji: 'ğŸ´', tip: 'å°é©¬è·‘å¾—å¿«' },
                            { char: 'ç‰›', pinyin: 'niÃº', options: ['niÃº', 'niÅ«', 'niÇ”'], emoji: 'ğŸ„', tip: 'å¤§é»„ç‰›å¾ˆå¼ºå£®' },
                            { char: 'ç¾Š', pinyin: 'yÃ¡ng', options: ['yÃ¡ng', 'yÄng', 'yÇng'], emoji: 'ğŸ‘', tip: 'å°ç¾Šå’©å’©å«' },
                            { char: 'çŒª', pinyin: 'zhÅ«', options: ['zhÅ«', 'zhÃº', 'zhÇ”'], emoji: 'ğŸ·', tip: 'å°çŒªçˆ±ç¡è§‰' },
                            { char: 'ç‹—', pinyin: 'gÇ’u', options: ['gÇ’u', 'gÅu', 'gÃ³u'], emoji: 'ğŸ¶', tip: 'å°ç‹—æ±ªæ±ªå«' },
                            { char: 'çŒ«', pinyin: 'mÄo', options: ['mÄo', 'mÃ¡o', 'mÇo'], emoji: 'ğŸ±', tip: 'å°çŒ«å–µå–µå«' },
                            { char: 'é¸¡', pinyin: 'jÄ«', options: ['jÄ«', 'jÃ­', 'jÇ'], emoji: 'ğŸ”', tip: 'å…¬é¸¡å–”å–”å«' },
                            { char: 'é¸­', pinyin: 'yÄ', options: ['yÄ', 'yÃ¡', 'yÇ'], emoji: 'ğŸ¦†', tip: 'é¸­å­å˜å˜å«' },
                            { char: 'é±¼', pinyin: 'yÃº', options: ['yÃº', 'yÅ«', 'yÇ”'], emoji: 'ğŸŸ', tip: 'å°é±¼æ°´ä¸­æ¸¸' },
                            { char: 'é¸Ÿ', pinyin: 'niÇo', options: ['niÇo', 'niÄo', 'niÃ¡o'], emoji: 'ğŸ¦', tip: 'å°é¸Ÿå¤©ä¸Šé£' }
                        ]
                    },
                    food: {
                        name: 'èœå¸‚åœº',
                        icon: 'ğŸ',
                        data: [
                            { char: 'ç±³', pinyin: 'mÇ', options: ['mÇ', 'mÄ«', 'mÃ­'], emoji: 'ğŸš', tip: 'ç™½ç±³é¦™åˆç”œ' },
                            { char: 'é¢', pinyin: 'miÃ n', options: ['miÃ n', 'miÄn', 'miÇn'], emoji: 'ğŸœ', tip: 'é¢æ¡é•¿åˆç»†' },
                            { char: 'è‚‰', pinyin: 'rÃ²u', options: ['rÃ²u', 'rÅu', 'rÃ³u'], emoji: 'ğŸ¥©', tip: 'çº¢çƒ§è‚‰çœŸé¦™' },
                            { char: 'è›‹', pinyin: 'dÃ n', options: ['dÃ n', 'dÄn', 'dÇn'], emoji: 'ğŸ¥š', tip: 'é¸¡è›‹è¥å…»å¥½' },
                            { char: 'èœ', pinyin: 'cÃ i', options: ['cÃ i', 'cÄi', 'cÃ¡i'], emoji: 'ğŸ¥¬', tip: 'é’èœç»¿æ²¹æ²¹' },
                            { char: 'æœ', pinyin: 'guÇ’', options: ['guÇ’', 'guÅ', 'guÃ³'], emoji: 'ğŸ', tip: 'è‹¹æœçº¢åˆç”œ' }
                        ]
                    }
                }
            },
            // ğŸŒŸ åŸºç¡€ - åŒå­—è¯æ±‡  
            basic: {
                name: 'åŸºç¡€çº§',
                description: 'åŒå­—è¯æ±‡ç»ƒä¹ ',
                timeLimit: 18,
                scenarios: {
                    family: {
                        name: 'æ¸©é¦¨å®¶åº­',
                        icon: 'ğŸ ',
                        data: [
                            { char: 'çˆ¸çˆ¸', pinyin: 'bÃ ba', options: ['bÃ ba', 'bÃ¡ba', 'bÇba', 'bÄba'], emoji: 'ğŸ‘¨', tip: 'çˆ¸çˆ¸å¾ˆé«˜å¤§' },
                            { char: 'å¦ˆå¦ˆ', pinyin: 'mÄma', options: ['mÄma', 'mÃ¡ma', 'mÇma', 'mÃ ma'], emoji: 'ğŸ‘©', tip: 'å¦ˆå¦ˆå¾ˆæ¸©æŸ”' },
                            { char: 'çˆ·çˆ·', pinyin: 'yÃ©ye', options: ['yÃ©ye', 'yÄ“ye', 'yÄ›ye', 'yÃ¨ye'], emoji: 'ğŸ‘´', tip: 'çˆ·çˆ·ä¼šè®²æ•…äº‹' },
                            { char: 'å¥¶å¥¶', pinyin: 'nÇinai', options: ['nÇinai', 'nÄinai', 'nÃ¡inai', 'nÃ inai'], emoji: 'ğŸ‘µ', tip: 'å¥¶å¥¶åšé¥­é¦™' },
                            { char: 'å“¥å“¥', pinyin: 'gÄ“ge', options: ['gÄ“ge', 'gÃ©ge', 'gÄ›ge', 'gÃ¨ge'], emoji: 'ğŸ‘¦', tip: 'å“¥å“¥ä¿æŠ¤æˆ‘' },
                            { char: 'å§å§', pinyin: 'jiÄ›jie', options: ['jiÄ›jie', 'jiÄ“jie', 'jiÃ©jie', 'jiÃ¨cjie'], emoji: 'ğŸ‘§', tip: 'å§å§å¾ˆç¾ä¸½' }
                        ]
                    },
                    daily: {
                        name: 'æ—¥å¸¸ç”¨å“',
                        icon: 'ğŸ’',
                        data: [
                            { char: 'ä¹¦åŒ…', pinyin: 'shÅ«bÄo', options: ['shÅ«bÄo', 'shÃºbÄo', 'shÇ”bÄo', 'shÃ¹bÄo'], emoji: 'ğŸ’', tip: 'ä¹¦åŒ…è£…è¯¾æœ¬' },
                            { char: 'æ°´æ¯', pinyin: 'shuÇbÄ“i', options: ['shuÇbÄ“i', 'shuÃ­bÄ“i', 'shuÃ¬bÄ“i', 'shuÄ«bÄ“i'], emoji: 'ğŸ¥¤', tip: 'æ°´æ¯å–æ°´ç”¨' },
                            { char: 'ç©å…·', pinyin: 'wÃ¡njÃ¹', options: ['wÃ¡njÃ¹', 'wÇnjÃ¹', 'wÃ njÃ¹', 'wÄnjÃ¹'], emoji: 'ğŸ§¸', tip: 'ç©å…·çœŸå¥½ç©' },
                            { char: 'è¡£æœ', pinyin: 'yÄ«fu', options: ['yÄ«fu', 'yÃ­fu', 'yÇfu', 'yÃ¬fu'], emoji: 'ğŸ‘•', tip: 'è¡£æœè¦ç©¿å¥½' },
                            { char: 'é‹å­', pinyin: 'xiÃ©zi', options: ['xiÃ©zi', 'xiÄ“zi', 'xiÄ›zi', 'xiÃ¨zi'], emoji: 'ğŸ‘Ÿ', tip: 'é‹å­ä¿æŠ¤è„š' }
                        ]
                    }
                }
            },
            // ğŸŒŸ è¿›é˜¶ - ä¸‰å­—è¯æ±‡
            advanced: {
                name: 'è¿›é˜¶çº§',
                description: 'ä¸‰å­—è¯æ±‡ç»ƒä¹ ',
                timeLimit: 15,
                scenarios: {
                    school: {
                        name: 'æ ¡å›­ç”Ÿæ´»',
                        icon: 'ğŸ«',
                        data: [
                            { char: 'è€å¸ˆ', pinyin: 'lÇoshÄ«', options: ['lÇoshÄ«', 'lÃ¡oshÄ«', 'lÃ oshÄ«', 'lÄoshÄ«'], emoji: 'ğŸ‘©â€ğŸ«', tip: 'è€å¸ˆæ•™æˆ‘ä»¬çŸ¥è¯†' },
                            { char: 'åŒå­¦', pinyin: 'tÃ³ngxuÃ©', options: ['tÃ³ngxuÃ©', 'tÅngxuÃ©', 'tÇ’ngxuÃ©', 'tÃ²ngxuÃ©'], emoji: 'ğŸ‘«', tip: 'åŒå­¦ä¸€èµ·å­¦ä¹ ' },
                            { char: 'æ•™å®¤', pinyin: 'jiÃ oshÃ¬', options: ['jiÃ oshÃ¬', 'jiÄoshÃ¬', 'jiÃ¡oshÃ¬', 'jiÇoshÃ¬'], emoji: 'ğŸ«', tip: 'æ•™å®¤é‡Œå¾ˆå®‰é™' },
                            { char: 'é»‘æ¿', pinyin: 'hÄ“ibÇn', options: ['hÄ“ibÇn', 'hÃ©ibÇn', 'hÄ›ibÇn', 'hÃ¨ibÇn'], emoji: 'â¬›', tip: 'é»‘æ¿ä¸Šå†™å­—' },
                            { char: 'è¯¾æœ¬', pinyin: 'kÃ¨bÄ›n', options: ['kÃ¨bÄ›n', 'kÄ“bÄ›n', 'kÃ©bÄ›n', 'kÄ›bÄ›n'], emoji: 'ğŸ“–', tip: 'è¯¾æœ¬é‡Œæœ‰çŸ¥è¯†' },
                            { char: 'é“…ç¬”', pinyin: 'qiÄnbÇ', options: ['qiÄnbÇ', 'qiÃ¡nbÇ', 'qiÇnbÇ', 'qiÃ nbÇ'], emoji: 'âœï¸', tip: 'é“…ç¬”ç”¨æ¥å†™å­—' }
                        ]
                    }
                }
            },
            // ğŸŒŸ æŒ‘æˆ˜ - å¤æ‚éŸ³èŠ‚
            expert: {
                name: 'æŒ‘æˆ˜çº§',
                description: 'å¤æ‚éŸ³èŠ‚ç»ƒä¹ ',
                timeLimit: 12,
                scenarios: {
                    nature: {
                        name: 'è‡ªç„¶ä¸–ç•Œ',
                        icon: 'ğŸŒ¸',
                        data: [
                            { char: 'èœ»èœ“', pinyin: 'qÄ«ngtÃ­ng', options: ['qÄ«ngtÃ­ng', 'qÃ­ngtÃ­ng', 'qÇngtÃ­ng', 'qÃ¬ngtÃ­ng'], emoji: 'ğŸœƒ', tip: 'èœ»èœ“ç‚¹æ°´è½»åˆå¿«' },
                            { char: 'è´è¶', pinyin: 'hÃºdiÃ©', options: ['hÃºdiÃ©', 'hÅ«diÃ©', 'hÇ”diÃ©', 'hÃ¹diÃ©'], emoji: 'ğŸ¦‹', tip: 'è´è¶èŠ±é—´é£èˆ' },
                            { char: 'èœœèœ‚', pinyin: 'mÃ¬fÄ“ng', options: ['mÃ¬fÄ“ng', 'mÄ«fÄ“ng', 'mÃ­fÄ“ng', 'mÇfÄ“ng'], emoji: 'ğŸ', tip: 'èœœèœ‚é‡‡èœœå¿™' },
                            { char: 'å½©è™¹', pinyin: 'cÇihÃ³ng', options: ['cÇihÃ³ng', 'cÄihÃ³ng', 'cÃ¡ihÃ³ng', 'cÃ ihÃ³ng'], emoji: 'ğŸŒˆ', tip: 'é›¨åå½©è™¹æŒ‚å¤©ç©º' },
                            { char: 'å‘æ—¥è‘µ', pinyin: 'xiÃ ngrÃ­kuÃ­', options: ['xiÃ ngrÃ­kuÃ­', 'xiÇngrÃ­kuÃ­', 'xiÃ¡ngrÃ­kuÃ­', 'xiÄngrÃ­kuÃ­'], emoji: 'ğŸŒ»', tip: 'å‘æ—¥è‘µå‘ç€å¤ªé˜³' },
                            { char: 'è’²å…¬è‹±', pinyin: 'pÃºgÅngyÄ«ng', options: ['pÃºgÅngyÄ«ng', 'pÇ”gÅngyÄ«ng', 'pÃ¹gÅngyÄ«ng', 'pÅ«gÅngyÄ«ng'], emoji: 'ğŸŒ¼', tip: 'è’²å…¬è‹±ç§å­ä¼šé£' }
                        ]
                    }
                }
            },
            // å…¼å®¹æ—§çš„éš¾åº¦åç§°
            easy: {
                name: 'å¯è’™çº§',
                description: 'å•å­—æ‹¼éŸ³ç»ƒä¹ ',
                timeLimit: 20,
                scenarios: {
                    animals: {
                        name: 'åŠ¨ç‰©å›­',
                        icon: 'ğŸ¾',
                        data: [
                            { char: 'é©¬', pinyin: 'mÇ', options: ['mÇ', 'mÄ', 'mÃ¡'], emoji: 'ğŸ´', tip: 'å°é©¬è·‘å¾—å¿«' },
                            { char: 'ç‰›', pinyin: 'niÃº', options: ['niÃº', 'niÅ«', 'niÇ”'], emoji: 'ğŸ„', tip: 'å¤§é»„ç‰›å¾ˆå¼ºå£®' },
                            { char: 'ç¾Š', pinyin: 'yÃ¡ng', options: ['yÃ¡ng', 'yÄng', 'yÇng'], emoji: 'ğŸ‘', tip: 'å°ç¾Šå’©å’©å«' },
                            { char: 'çŒª', pinyin: 'zhÅ«', options: ['zhÅ«', 'zhÃº', 'zhÇ”'], emoji: 'ğŸ·', tip: 'å°çŒªçˆ±ç¡è§‰' },
                            { char: 'ç‹—', pinyin: 'gÇ’u', options: ['gÇ’u', 'gÅu', 'gÃ³u'], emoji: 'ğŸ¶', tip: 'å°ç‹—æ±ªæ±ªå«' },
                            { char: 'çŒ«', pinyin: 'mÄo', options: ['mÄo', 'mÃ¡o', 'mÇo'], emoji: 'ğŸ±', tip: 'å°çŒ«å–µå–µå«' }
                        ]
                    }
                }
            },
            medium: {
                name: 'åŸºç¡€çº§',
                description: 'åŒå­—è¯æ±‡ç»ƒä¹ ', 
                timeLimit: 18,
                scenarios: {
                    family: {
                        name: 'æ¸©é¦¨å®¶åº­',
                        icon: 'ğŸ ',
                        data: [
                            { char: 'çˆ¸çˆ¸', pinyin: 'bÃ ba', options: ['bÃ ba', 'bÃ¡ba', 'bÇba', 'bÄba'], emoji: 'ğŸ‘¨', tip: 'çˆ¸çˆ¸å¾ˆé«˜å¤§' },
                            { char: 'å¦ˆå¦ˆ', pinyin: 'mÄma', options: ['mÄma', 'mÃ¡ma', 'mÇma', 'mÃ ma'], emoji: 'ğŸ‘©', tip: 'å¦ˆå¦ˆå¾ˆæ¸©æŸ”' },
                            { char: 'çˆ·çˆ·', pinyin: 'yÃ©ye', options: ['yÃ©ye', 'yÄ“ye', 'yÄ›ye', 'yÃ¨ye'], emoji: 'ğŸ‘´', tip: 'çˆ·çˆ·ä¼šè®²æ•…äº‹' },
                            { char: 'å¥¶å¥¶', pinyin: 'nÇinai', options: ['nÇinai', 'nÄinai', 'nÃ¡inai', 'nÃ inai'], emoji: 'ğŸ‘µ', tip: 'å¥¶å¥¶åšé¥­é¦™' }
                        ]
                    }
                }
            },
            hard: {
                name: 'è¿›é˜¶çº§',
                description: 'ä¸‰å­—è¯æ±‡ç»ƒä¹ ',
                timeLimit: 15,
                scenarios: {
                    school: {
                        name: 'æ ¡å›­ç”Ÿæ´»',
                        icon: 'ğŸ«',
                        data: [
                            { char: 'è€å¸ˆ', pinyin: 'lÇoshÄ«', options: ['lÇoshÄ«', 'lÃ¡oshÄ«', 'lÃ oshÄ«', 'lÄoshÄ«'], emoji: 'ğŸ‘©â€ğŸ«', tip: 'è€å¸ˆæ•™æˆ‘ä»¬çŸ¥è¯†' },
                            { char: 'åŒå­¦', pinyin: 'tÃ³ngxuÃ©', options: ['tÃ³ngxuÃ©', 'tÅngxuÃ©', 'tÇ’ngxuÃ©', 'tÃ²ngxuÃ©'], emoji: 'ğŸ‘«', tip: 'åŒå­¦ä¸€èµ·å­¦ä¹ ' },
                            { char: 'æ•™å®¤', pinyin: 'jiÃ oshÃ¬', options: ['jiÃ oshÃ¬', 'jiÄoshÃ¬', 'jiÃ¡oshÃ¬', 'jiÇoshÃ¬'], emoji: 'ğŸ«', tip: 'æ•™å®¤é‡Œå¾ˆå®‰é™' }
                        ]
                    }
                }
            }
        };

        // å£°æ¯éŸµæ¯åŸºç¡€å­¦ä¹ æ•°æ®
        const basicLearningData = {
            consonants: {
                name: 'å£°æ¯å­¦ä¹ ',
                description: 'å­¦ä¹ 23ä¸ªå£°æ¯çš„å‘éŸ³',
                timeLimit: 20,
                data: [
                    { char: 'b', pinyin: 'b', sound: 'ç»', options: ['b', 'p', 'd'], emoji: 'ğŸ‘¦', tip: 'båƒä¸ª6ï¼Œå˜´å·´æŠ¿ç€å‘éŸ³', example: 'çˆ¸ba' },
                    { char: 'p', pinyin: 'p', sound: 'å¡', options: ['p', 'b', 't'], emoji: 'ğŸ’¨', tip: 'påƒä¸ªå°æ——ï¼Œå˜´å·´é€æ°”å‘éŸ³', example: 'è·‘pÇo' },
                    { char: 'm', pinyin: 'm', sound: 'æ‘¸', options: ['m', 'n', 'f'], emoji: 'ğŸ‘„', tip: 'måƒä¸¤æ‰‡é—¨ï¼Œå˜´å·´é—­ç€å‘éŸ³', example: 'å¦ˆmÄ' },
                    { char: 'f', pinyin: 'f', sound: 'ä½›', options: ['f', 'h', 'm'], emoji: 'ğŸŒ¬ï¸', tip: 'fåƒä¸€æ ¹æ‹æ–ï¼Œä¸Šç‰™å’¬ä¸‹å”‡', example: 'é£fÄ“i' },
                    { char: 'd', pinyin: 'd', sound: 'å¾—', options: ['d', 't', 'b'], emoji: 'ğŸ¥', tip: 'dåƒåŠä¸ªåœ†ï¼ŒèˆŒå°–é¡¶ä¸Šé½¿', example: 'å¤§dÃ ' },
                    { char: 't', pinyin: 't', sound: 'ç‰¹', options: ['t', 'd', 'p'], emoji: 'â˜‚ï¸', tip: 'tåƒå°ä¼ï¼ŒèˆŒå°–é¡¶ä¸Šé½¿é€æ°”', example: 'å…”tÃ¹' },
                    { char: 'n', pinyin: 'n', sound: 'è®·', options: ['n', 'l', 'm'], emoji: 'ğŸ‘ƒ', tip: 'nåƒé—¨æ´ï¼ŒèˆŒå°–é¡¶ä¸Šé½¿', example: 'ç‰›niÃº' },
                    { char: 'l', pinyin: 'l', sound: 'å‹’', options: ['l', 'n', 'r'], emoji: 'ğŸƒ', tip: 'låƒæ•°å­—1ï¼ŒèˆŒå°–é¡¶ä¸Šé½¿', example: 'è€lÇo' },
                    { char: 'g', pinyin: 'g', sound: 'å“¥', options: ['g', 'k', 'd'], emoji: 'ğŸª', tip: 'gåƒ9å­—é’©ï¼ŒèˆŒæ ¹é¡¶è½¯è…­', example: 'ç‹—gÇ’u' },
                    { char: 'k', pinyin: 'k', sound: 'ç§‘', options: ['k', 'g', 't'], emoji: 'ğŸ”‘', tip: 'kåƒæœºå…³æªï¼ŒèˆŒæ ¹é¡¶è½¯è…­é€æ°”', example: 'çœ‹kÃ n' },
                    { char: 'h', pinyin: 'h', sound: 'å–', options: ['h', 'f', 'x'], emoji: 'ğŸ˜¤', tip: 'håƒæ¤…å­ï¼ŒèˆŒæ ¹è½»å¾®æ‘©æ“¦', example: 'å¥½hÇo' },
                    { char: 'j', pinyin: 'j', sound: 'åŸº', options: ['j', 'q', 'z'], emoji: 'ğŸª', tip: 'jåƒç§¤é’©ï¼ŒèˆŒé¢å‰éƒ¨è´´ç¡¬è…­', example: 'é¸¡jÄ«' },
                    { char: 'q', pinyin: 'q', sound: 'æ¬º', options: ['q', 'j', 'c'], emoji: 'ğŸˆ', tip: 'qåƒæ°”çƒï¼ŒèˆŒé¢å‰éƒ¨è´´ç¡¬è…­é€æ°”', example: 'ä¸ƒqÄ«' },
                    { char: 'x', pinyin: 'x', sound: 'å¸Œ', options: ['x', 's', 'h'], emoji: 'âŒ', tip: 'xåƒä¹˜å·ï¼ŒèˆŒé¢å‰éƒ¨æ¥è¿‘ç¡¬è…­', example: 'è¥¿xÄ«' },
                    { char: 'z', pinyin: 'z', sound: 'èµ„', options: ['z', 'c', 'j'], emoji: 'ğŸ¦“', tip: 'zåƒæ•°å­—2ï¼ŒèˆŒå°–å‰ä¼¸', example: 'å­—zÃ¬' },
                    { char: 'c', pinyin: 'c', sound: 'é›Œ', options: ['c', 'z', 'q'], emoji: 'ğŸŒ™', tip: 'cåƒå¼¯æœˆï¼ŒèˆŒå°–å‰ä¼¸é€æ°”', example: 'è‰cÇo' },
                    { char: 's', pinyin: 's', sound: 'æ€', options: ['s', 'x', 'sh'], emoji: 'ğŸ', tip: 'såƒè›‡å½¢ï¼ŒèˆŒå°–å‰ä¼¸', example: 'å››sÃ¬' },
                    { char: 'zh', pinyin: 'zh', sound: 'çŸ¥', options: ['zh', 'z', 'ch'], emoji: 'ğŸ•·ï¸', tip: 'zhåƒèœ˜è››ï¼ŒèˆŒå°–ç¿˜èµ·', example: 'ä¸­zhÅng' },
                    { char: 'ch', pinyin: 'ch', sound: 'åƒ', options: ['ch', 'zh', 'c'], emoji: 'ğŸš—', tip: 'chåƒè½¦è½®ï¼ŒèˆŒå°–ç¿˜èµ·é€æ°”', example: 'åƒchÄ«' },
                    { char: 'sh', pinyin: 'sh', sound: 'è¯—', options: ['sh', 's', 'zh'], emoji: 'ğŸ¤«', tip: 'shåƒå˜˜å£°ï¼ŒèˆŒå°–ç¿˜èµ·', example: 'åshÃ­' },
                    { char: 'r', pinyin: 'r', sound: 'æ—¥', options: ['r', 'l', 'y'], emoji: 'â˜€ï¸', tip: 'råƒå°è‹—ï¼ŒèˆŒå°–ç¿˜èµ·', example: 'äººrÃ©n' },
                    { char: 'y', pinyin: 'y', sound: 'è¡£', options: ['y', 'w', 'r'], emoji: 'ğŸŒ±', tip: 'yåƒå°æ ‘ï¼ŒèˆŒé¢å‰éƒ¨ä¸Šå‡', example: 'ä¸€yÄ«' },
                    { char: 'w', pinyin: 'w', sound: 'ä¹Œ', options: ['w', 'y', 'u'], emoji: 'ã€°ï¸', tip: 'wåƒæ³¢æµªï¼Œå˜´å·´åœ†åœ†çš„', example: 'æˆ‘wÇ’' }
                ]
            },
            vowels: {
                name: 'éŸµæ¯å­¦ä¹ ',
                description: 'å­¦ä¹ 24ä¸ªéŸµæ¯çš„å‘éŸ³',
                timeLimit: 20,
                data: [
                    // å•éŸµæ¯
                    { char: 'a', pinyin: 'a', sound: 'å•Š', options: ['a', 'o', 'e'], emoji: 'ğŸ‘„', tip: 'å˜´å·´å¼ å¤§ï¼Œå‘"å•Š"éŸ³', example: 'çˆ¸bÃ ', type: 'å•éŸµæ¯' },
                    { char: 'o', pinyin: 'o', sound: 'å–”', options: ['o', 'a', 'u'], emoji: 'â­•', tip: 'å˜´å·´åœ†åœ†ï¼Œå‘"å–”"éŸ³', example: 'å“¦Ã²', type: 'å•éŸµæ¯' },
                    { char: 'e', pinyin: 'e', sound: 'é¹…', options: ['e', 'a', 'i'], emoji: 'ğŸ˜¯', tip: 'å˜´åŠå¼€ï¼Œå‘"é¹…"éŸ³', example: 'é¹…Ã©', type: 'å•éŸµæ¯' },
                    { char: 'i', pinyin: 'i', sound: 'è¡£', options: ['i', 'u', 'y'], emoji: 'ğŸ˜Š', tip: 'å˜´è§’æ‹‰å¼€ï¼Œå‘"è¡£"éŸ³', example: 'è¡£yÄ«', type: 'å•éŸµæ¯' },
                    { char: 'u', pinyin: 'u', sound: 'ä¹Œ', options: ['u', 'o', 'w'], emoji: 'ğŸ¤', tip: 'å˜´å·´æ’…èµ·ï¼Œå‘"ä¹Œ"éŸ³', example: 'ä¹ŒwÅ«', type: 'å•éŸµæ¯' },
                    { char: 'Ã¼', pinyin: 'Ã¼', sound: 'è¿‚', options: ['Ã¼', 'u', 'i'], emoji: 'ğŸ’‹', tip: 'åƒå¹å£å“¨ï¼Œå‘"è¿‚"éŸ³', example: 'é±¼yÃº', type: 'å•éŸµæ¯' },
                    
                    // å¤éŸµæ¯
                    { char: 'ai', pinyin: 'ai', sound: 'å“€', options: ['ai', 'ao', 'ei'], emoji: 'ğŸ¤²', tip: 'a+iï¼Œä»"å•Š"åˆ°"è¡£"', example: 'çˆ±Ã i', type: 'å¤éŸµæ¯' },
                    { char: 'ei', pinyin: 'ei', sound: 'è¯¶', options: ['ei', 'ai', 'ui'], emoji: 'ğŸ‘‹', tip: 'e+iï¼Œä»"é¹…"åˆ°"è¡£"', example: 'é»‘hÄ“i', type: 'å¤éŸµæ¯' },
                    { char: 'ui', pinyin: 'ui', sound: 'å¨', options: ['ui', 'iu', 'ai'], emoji: 'ğŸŒŠ', tip: 'u+iï¼Œä»"ä¹Œ"åˆ°"è¡£"', example: 'æ°´shuÇ', type: 'å¤éŸµæ¯' },
                    { char: 'ao', pinyin: 'ao', sound: 'ç†¬', options: ['ao', 'ou', 'ai'], emoji: 'ğŸ˜®', tip: 'a+oï¼Œä»"å•Š"åˆ°"å“¦"', example: 'çŒ«mÄo', type: 'å¤éŸµæ¯' },
                    { char: 'ou', pinyin: 'ou', sound: 'æ¬§', options: ['ou', 'ao', 'iu'], emoji: 'ğŸ‘´', tip: 'o+uï¼Œä»"å“¦"åˆ°"ä¹Œ"', example: 'å£kÇ’u', type: 'å¤éŸµæ¯' },
                    { char: 'iu', pinyin: 'iu', sound: 'ä¼˜', options: ['iu', 'ui', 'ou'], emoji: 'ğŸŠ', tip: 'i+uï¼Œä»"è¡£"åˆ°"ä¹Œ"', example: 'ç‰›niÃº', type: 'å¤éŸµæ¯' },
                    
                    // é¼»éŸµæ¯
                    { char: 'an', pinyin: 'an', sound: 'å®‰', options: ['an', 'en', 'ang'], emoji: 'ğŸ‘ƒ', tip: 'a+nï¼Œå‘"å®‰"éŸ³', example: 'å®‰Än', type: 'é¼»éŸµæ¯' },
                    { char: 'en', pinyin: 'en', sound: 'æ©', options: ['en', 'an', 'in'], emoji: 'ğŸ¤”', tip: 'e+nï¼Œå‘"æ©"éŸ³', example: 'æ©Ä“n', type: 'é¼»éŸµæ¯' },
                    { char: 'in', pinyin: 'in', sound: 'å› ', options: ['in', 'un', 'en'], emoji: 'ğŸ“Œ', tip: 'i+nï¼Œå‘"å› "éŸ³', example: 'å› yÄ«n', type: 'é¼»éŸµæ¯' },
                    { char: 'un', pinyin: 'un', sound: 'æ¸©', options: ['un', 'in', 'Ã¼n'], emoji: 'ğŸŒ™', tip: 'u+nï¼Œå‘"æ¸©"éŸ³', example: 'æ–‡wÃ©n', type: 'é¼»éŸµæ¯' },
                    { char: 'Ã¼n', pinyin: 'Ã¼n', sound: 'æ™•', options: ['Ã¼n', 'un', 'in'], emoji: 'ğŸµ', tip: 'Ã¼+nï¼Œå‘"æ™•"éŸ³', example: 'äº‘yÃºn', type: 'é¼»éŸµæ¯' },
                    { char: 'ang', pinyin: 'ang', sound: 'æ˜‚', options: ['ang', 'eng', 'an'], emoji: 'ğŸ˜®', tip: 'a+ngï¼Œå‘"æ˜‚"éŸ³', example: 'æ˜‚Ã¡ng', type: 'åé¼»éŸµæ¯' },
                    { char: 'eng', pinyin: 'eng', sound: 'é¥', options: ['eng', 'ang', 'ing'], emoji: 'ğŸ””', tip: 'e+ngï¼Œå‘"é¥"éŸ³', example: 'ç¯dÄ“ng', type: 'åé¼»éŸµæ¯' },
                    { char: 'ing', pinyin: 'ing', sound: 'è‹±', options: ['ing', 'ong', 'eng'], emoji: 'ğŸŒŸ', tip: 'i+ngï¼Œå‘"è‹±"éŸ³', example: 'è‹±yÄ«ng', type: 'åé¼»éŸµæ¯' },
                    { char: 'ong', pinyin: 'ong', sound: 'å—¡', options: ['ong', 'ing', 'ang'], emoji: 'ğŸ”Š', tip: 'o+ngï¼Œå‘"å—¡"éŸ³', example: 'çº¢hÃ³ng', type: 'åé¼»éŸµæ¯' }
                ]
            }
        };

        // å½“å‰æ¸¸æˆçŠ¶æ€
        let currentScenario = '';
        let currentScenarioData = [];
        let usedQuestions = [];
        let currentGameMode = ''; // 'consonants', 'vowels', 'difficulty'

        // åˆå§‹åŒ–
        function init() {
            // ç»‘å®šåŸºç¡€å­¦ä¹ æ¨¡å¼æŒ‰é’®
            const modeBtns = document.querySelectorAll('.mode-btn');
            modeBtns.forEach(btn => {
                btn.addEventListener('click', function() {
                    // æ¸…é™¤æ‰€æœ‰é€‰ä¸­çŠ¶æ€
                    modeBtns.forEach(b => b.classList.remove('ring-4', 'ring-primary'));
                    difficultyBtns.forEach(b => b.classList.remove('ring-4', 'ring-primary'));
                    
                    // æ·»åŠ å½“å‰æŒ‰é’®çš„é€‰ä¸­çŠ¶æ€
                    this.classList.add('ring-4', 'ring-primary');
                    currentGameMode = this.dataset.mode;
                    currentLevel = ''; // æ¸…é™¤éš¾åº¦é€‰æ‹©
                    
                    startBtn.disabled = false;
                    startBtn.classList.remove('opacity-50', 'cursor-not-allowed');
                    
                    // æ›´æ–°å¼€å§‹æŒ‰é’®æ–‡å­—
                    if (currentGameMode === 'consonants') {
                        startBtn.innerHTML = 'å¼€å§‹å­¦å£°æ¯ <i class="fa fa-play ml-2"></i>';
                    } else if (currentGameMode === 'vowels') {
                        startBtn.innerHTML = 'å¼€å§‹å­¦éŸµæ¯ <i class="fa fa-play ml-2"></i>';
                    }
                });
            });

            // ç»‘å®šéš¾åº¦é€‰æ‹©æŒ‰é’®
            difficultyBtns.forEach(btn => {
                btn.addEventListener('click', function() {
                    // æ¸…é™¤æ‰€æœ‰é€‰ä¸­çŠ¶æ€
                    modeBtns.forEach(b => b.classList.remove('ring-4', 'ring-primary'));
                    difficultyBtns.forEach(b => b.classList.remove('ring-4', 'ring-primary'));
                    
                    // æ·»åŠ å½“å‰æŒ‰é’®çš„é€‰ä¸­çŠ¶æ€
                    this.classList.add('ring-4', 'ring-primary');
                    currentLevel = this.dataset.level;
                    currentGameMode = 'difficulty'; // è®¾ç½®ä¸ºéš¾åº¦æ¨¡å¼
                    
                    startBtn.disabled = false;
                    startBtn.classList.remove('opacity-50', 'cursor-not-allowed');
                    
                    // æ¢å¤å¼€å§‹æŒ‰é’®æ–‡å­—
                    startBtn.innerHTML = 'å¼€å§‹å­¦ä¹  <i class="fa fa-play ml-2"></i>';
                });
            });

            // ç»‘å®šå€’è®¡æ—¶å¼€å…³
            timerToggle.addEventListener('change', function() {
                isTimerEnabled = this.checked;
                timerDescription.textContent = isTimerEnabled ? 'æ ¹æ®éš¾åº¦é™æ—¶' : 'æ— æ—¶é—´é™åˆ¶';
            });

            // ç»‘å®šå¼€å§‹æŒ‰é’®
            startBtn.addEventListener('click', startGame);

            // ç»‘å®šé‡æ–°å¼€å§‹æŒ‰é’®
            restartBtn.addEventListener('click', function() {
                resetGame();
                showScreen('start');
            });

            // ç»‘å®šæ’­æ”¾å£°éŸ³æŒ‰é’®
            playSoundBtn.addEventListener('click', playCurrentSound);
        }

        // æ˜¾ç¤ºæŒ‡å®šå±å¹•
        function showScreen(screen) {
            startScreen.classList.add('hidden');
            gameScreen.classList.add('hidden');
            resultScreen.classList.add('hidden');
            
            switch(screen) {
                case 'start':
                    startScreen.classList.remove('hidden');
                    break;
                case 'game':
                    gameScreen.classList.remove('hidden');
                    break;
                case 'result':
                    resultScreen.classList.remove('hidden');
                    break;
            }
        }

        // å¼€å§‹æ¸¸æˆ
        function startGame() {
            resetGame();
            showScreen('game');
            nextQuestion();
        }

        // é‡ç½®æ¸¸æˆ
        function resetGame() {
            currentQuestion = 0;
            score = 0;
            combo = 0;
            maxCombo = 0;
            correctAnswers = 0;
            gameActive = true;
            clearInterval(timerInterval);
            
            // æ ¹æ®æ¸¸æˆæ¨¡å¼è®¾ç½®é¢˜ç›®æ•°é‡å’Œæ—¶é—´
            if (currentGameMode === 'consonants' || currentGameMode === 'vowels') {
                // åŸºç¡€å­¦ä¹ æ¨¡å¼
                totalQuestions = basicLearningData[currentGameMode].data.length;
                timeLeft = basicLearningData[currentGameMode].timeLimit;
            } else {
                // ç»¼åˆç»ƒä¹ æ¨¡å¼
                switch(currentLevel) {
                    case 'beginner':
                        totalQuestions = 8;
                        timeLeft = 20;
                        break;
                    case 'basic':
                        totalQuestions = 10;
                        timeLeft = 18;
                        break;
                    case 'advanced':
                        totalQuestions = 12;
                        timeLeft = 15;
                        break;
                    case 'expert':
                        totalQuestions = 15;
                        timeLeft = 12;
                        break;
                    // å…¼å®¹æ—§çš„éš¾åº¦åç§°
                    case 'easy':
                        totalQuestions = 8;
                        timeLeft = 20;
                        break;
                    case 'medium':
                        totalQuestions = 10;
                        timeLeft = 18;
                        break;
                    case 'hard':
                        totalQuestions = 12;
                        timeLeft = 15;
                        break;
                    default:
                        totalQuestions = 8;
                        timeLeft = 20;
                        break;
                }
            }
            
            // æ›´æ–°æ˜¾ç¤º
            updateUI();
        }

        // ä¸‹ä¸€é¢˜
        function nextQuestion() {
            if (currentQuestion >= totalQuestions) {
                endGame();
                return;
            }

            currentQuestion++;
            
            let questionData;
            
            // æ ¹æ®æ¸¸æˆæ¨¡å¼é€‰æ‹©é¢˜ç›®
            if (currentGameMode === 'consonants' || currentGameMode === 'vowels') {
                // åŸºç¡€å­¦ä¹ æ¨¡å¼
                if (currentScenarioData.length === 0) {
                    currentScenarioData = [...basicLearningData[currentGameMode].data];
                }
                
                // ä»åŸºç¡€å­¦ä¹ æ•°æ®ä¸­é€‰æ‹©æœªä½¿ç”¨çš„é¢˜ç›®
                let attempts = 0;
                do {
                    const randomIndex = Math.floor(Math.random() * currentScenarioData.length);
                    questionData = currentScenarioData[randomIndex];
                    attempts++;
                    
                    if (attempts > 20) {
                        usedQuestions = [];
                        break;
                    }
                } while (usedQuestions.includes(questionData.char));
                
            } else {
                // ç»¼åˆç»ƒä¹ æ¨¡å¼
                if (!currentScenario || currentScenarioData.length === 0) {
                    selectRandomScenario();
                }
                
                let attempts = 0;
                do {
                    const randomIndex = Math.floor(Math.random() * currentScenarioData.length);
                    questionData = currentScenarioData[randomIndex];
                    attempts++;
                    
                    if (attempts > 20) {
                        usedQuestions = [];
                        break;
                    }
                } while (usedQuestions.includes(questionData.char));
            }
            
            usedQuestions.push(questionData.char);
            
            currentCharacter = questionData.char;
            currentPinyin = questionData.pinyin;
            
            // æ ¹æ®æ¨¡å¼æ˜¾ç¤ºä¸åŒå†…å®¹å’Œæ›´æ–°æŒ‰é’®æ–‡å­—
            const playBtnText = document.getElementById('play-btn-text');
            
            if (currentGameMode === 'consonants' || currentGameMode === 'vowels') {
                // åŸºç¡€å­¦ä¹ ï¼šåˆå§‹éšè—æ‹¼éŸ³å­—æ¯ï¼Œåªæ˜¾ç¤ºé—®å·
                characterDisplay.innerHTML = `
                    <div class="flex flex-col items-center justify-center gap-3">
                        <span class="text-4xl">${questionData.emoji}</span>
                        <div id="question-mark" class="text-8xl font-bold text-gray-400 bg-gray-100 px-8 py-6 rounded-2xl shadow-lg border-4 border-gray-200">
                            ?
                        </div>
                        <div id="hidden-answer" class="hidden text-8xl font-bold text-primary bg-white px-6 py-4 rounded-2xl shadow-lg border-4 border-primary/20">
                            ${questionData.char}
                        </div>
                        <div class="text-center">
                            <p class="text-lg text-gray-600">å¬éŸ³é€‰æ‹©æ­£ç¡®çš„${currentGameMode === 'consonants' ? 'å£°æ¯' : 'éŸµæ¯'}</p>
                            <p class="text-sm text-gray-500 mt-1">ç‚¹å‡»æ’­æ”¾æŒ‰é’®å¬è¯»éŸ³</p>
                        </div>
                    </div>
                `;
                
                // æ›´æ–°æ’­æ”¾æŒ‰é’®æ–‡å­—
                playBtnText.textContent = `å¬${currentGameMode === 'consonants' ? 'å£°æ¯' : 'éŸµæ¯'}è¯»éŸ³`;
                
                // è‡ªåŠ¨æ’­æ”¾ä¸€æ¬¡è¯»éŸ³å¸®åŠ©å­¦ä¹ 
                setTimeout(() => {
                    playCurrentSound();
                }, 800);
                
            } else {
                // ç»¼åˆç»ƒä¹ ï¼šæ˜¾ç¤ºæ±‰å­—
                characterDisplay.innerHTML = `
                    <div class="flex items-center justify-center gap-4">
                        <span class="text-4xl">${questionData.emoji}</span>
                        <span class="text-6xl font-bold">${currentCharacter}</span>
                    </div>
                `;
                
                // æ¢å¤é»˜è®¤æŒ‰é’®æ–‡å­—
                playBtnText.textContent = 'æ’­æ”¾è¯»éŸ³';
            }
            
            // ç”Ÿæˆé€‰é¡¹
            generateOptions(questionData.options);
            
            // éšè—åé¦ˆ
            feedbackContent.classList.add('hidden');
            
            // å¼€å§‹è®¡æ—¶
            if (isTimerEnabled) {
                startTimer();
            } else {
                countdown.textContent = 'æ— é™åˆ¶';
            }
            
            // æ›´æ–°è¿›åº¦
            updateProgress();
            updateUI();
        }

        // é€‰æ‹©éšæœºåœºæ™¯
        function selectRandomScenario() {
            const levelData = pinyinData[currentLevel];
            const scenarios = Object.keys(levelData.scenarios);
            const randomScenario = scenarios[Math.floor(Math.random() * scenarios.length)];
            
            currentScenario = randomScenario;
            currentScenarioData = levelData.scenarios[randomScenario].data;
            usedQuestions = [];
            
            console.log(`é€‰æ‹©åœºæ™¯: ${levelData.scenarios[randomScenario].name}`);
        }

        // ç”Ÿæˆé€‰é¡¹æŒ‰é’®
        function generateOptions(options) {
            optionsContainer.innerHTML = '';
            
            // æ‰“ä¹±é€‰é¡¹é¡ºåº
            const shuffledOptions = [...options].sort(() => Math.random() - 0.5);
            
            shuffledOptions.forEach(option => {
                const button = document.createElement('button');
                button.className = 'option-btn bg-white hover:bg-gray-50 text-text font-bold py-4 px-6 rounded-2xl shadow-lg transform transition-all duration-300 hover:scale-105 active:scale-95 border-2 border-transparent hover:border-primary/30';
                button.textContent = option;
                button.addEventListener('click', () => selectAnswer(option, button));
                optionsContainer.appendChild(button);
            });
        }

        // é€‰æ‹©ç­”æ¡ˆ
        function selectAnswer(selectedOption, buttonElement) {
            if (!gameActive) return;
            
            clearInterval(timerInterval);
            gameActive = false;
            
            const isCorrect = selectedOption === currentPinyin;
            
            // åœ¨åŸºç¡€å­¦ä¹ æ¨¡å¼ä¸­ï¼Œæ˜¾ç¤ºéšè—çš„ç­”æ¡ˆ
            if (currentGameMode === 'consonants' || currentGameMode === 'vowels') {
                const questionMark = document.getElementById('question-mark');
                const hiddenAnswer = document.getElementById('hidden-answer');
                if (questionMark && hiddenAnswer) {
                    questionMark.classList.add('hidden');
                    hiddenAnswer.classList.remove('hidden');
                    hiddenAnswer.classList.add('level-complete'); // æ·»åŠ åŠ¨ç”»æ•ˆæœ
                }
            }
            
            // è§†è§‰åé¦ˆ
            if (isCorrect) {
                buttonElement.classList.add('correct-animation');
                buttonElement.style.backgroundColor = '#66BB6A';
                buttonElement.style.color = 'white';
                showFeedback(true, 'å¤ªæ£’äº†ï¼', `${currentCharacter} çš„æ‹¼éŸ³å°±æ˜¯ ${currentPinyin}`);
                
                // æ›´æ–°åˆ†æ•°å’Œè¿å‡»
                let baseScore = 10;
                switch(currentLevel) {
                    case 'beginner':
                    case 'easy':
                        baseScore = 10;
                        break;
                    case 'basic':
                    case 'medium':
                        baseScore = 15;
                        break;
                    case 'advanced':
                        baseScore = 20;
                        break;
                    case 'expert':
                    case 'hard':
                        baseScore = 25;
                        break;
                }
                const comboBonus = Math.min(combo * 2, 20);
                const timeBonus = isTimerEnabled ? Math.max(0, Math.floor(timeLeft)) : 0;
                const questionScore = baseScore + comboBonus + timeBonus;
                
                score += questionScore;
                combo++;
                correctAnswers++;
                maxCombo = Math.max(maxCombo, combo);
                
            } else {
                buttonElement.classList.add('wrong-animation');
                buttonElement.style.backgroundColor = '#EF5350';
                buttonElement.style.color = 'white';
                
                // é«˜äº®æ­£ç¡®ç­”æ¡ˆ
                Array.from(optionsContainer.children).forEach(btn => {
                    if (btn.textContent === currentPinyin) {
                        btn.style.backgroundColor = '#66BB6A';
                        btn.style.color = 'white';
                    }
                });
                
                showFeedback(false, 'åŠ æ²¹ï¼', `${currentCharacter} çš„æ­£ç¡®æ‹¼éŸ³æ˜¯ ${currentPinyin}`);
                combo = 0;
            }
            
            updateUI();
            
            // æ’­æ”¾è¯»éŸ³
            setTimeout(() => {
                playCurrentSound();
            }, 800);
            
            // å»¶è¿Ÿè¿›å…¥ä¸‹ä¸€é¢˜
            setTimeout(() => {
                gameActive = true;
                hideFeedback(); // éšè—åé¦ˆ
                nextQuestion();
            }, 3500);
        }

        // æ˜¾ç¤ºåé¦ˆ
        function showFeedback(isCorrect, title, detail) {
            feedbackText.textContent = title;
            feedbackText.className = `text-xl font-bold mb-2 ${isCorrect ? 'text-success' : 'text-danger'}`;
            
            // æ ¹æ®æ¸¸æˆæ¨¡å¼æ˜¾ç¤ºä¸åŒçš„è¯¦ç»†ä¿¡æ¯
            let feedbackHTML = detail;
            
            if (currentGameMode === 'consonants' || currentGameMode === 'vowels') {
                // åŸºç¡€å­¦ä¹ æ¨¡å¼çš„åé¦ˆ
                const currentData = basicLearningData[currentGameMode].data.find(item => item.char === currentCharacter);
                if (currentData) {
                    if (isCorrect) {
                        feedbackHTML = `
                            <div class="text-center">
                                <p class="text-sm mb-2">${currentData.tip}</p>
                                <p class="text-xs text-gray-600">ä¾‹å¦‚ï¼š<span class="font-bold text-primary">${currentData.example}</span></p>
                                ${currentData.type ? `<span class="inline-block bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded-full mt-1">${currentData.type}</span>` : ''}
                            </div>
                        `;
                    } else {
                        feedbackHTML = `
                            <div class="text-center">
                                <p class="text-sm mb-2">æ­£ç¡®ç­”æ¡ˆæ˜¯ï¼š<span class="font-bold text-success">${currentPinyin}</span></p>
                                <p class="text-xs text-gray-600 mb-1">${currentData.tip}</p>
                                <p class="text-xs text-gray-500">ä¾‹å¦‚ï¼š<span class="font-bold">${currentData.example}</span></p>
                            </div>
                        `;
                    }
                }
            }
            
            feedbackDetail.innerHTML = feedbackHTML;
            feedbackContent.classList.remove('hidden');
            
            // æ·»åŠ æ˜¾ç¤ºåŠ¨ç”»
            setTimeout(() => {
                feedbackContent.classList.add('level-complete');
            }, 100);
        }
        
        // éšè—åé¦ˆ
        function hideFeedback() {
            feedbackContent.classList.add('hidden');
            feedbackContent.classList.remove('level-complete');
        }

        // å¼€å§‹è®¡æ—¶
        function startTimer() {
            // æ ¹æ®æ¸¸æˆæ¨¡å¼è®¾ç½®æ—¶é—´
            if (currentGameMode === 'consonants' || currentGameMode === 'vowels') {
                // åŸºç¡€å­¦ä¹ æ¨¡å¼ä½¿ç”¨æ›´é•¿çš„æ—¶é—´
                timeLeft = basicLearningData[currentGameMode].timeLimit;
            } else {
                // ç»¼åˆç»ƒä¹ æ¨¡å¼æ ¹æ®éš¾åº¦è®¾ç½®æ—¶é—´
                switch(currentLevel) {
                    case 'beginner':
                        timeLeft = 20;
                        break;
                    case 'basic':
                        timeLeft = 18;
                        break;
                    case 'advanced':
                        timeLeft = 15;
                        break;
                    case 'expert':
                        timeLeft = 12;
                        break;
                    // å…¼å®¹æ—§çš„éš¾åº¦åç§°
                    case 'easy':
                        timeLeft = 20;
                        break;
                    case 'medium':
                        timeLeft = 18;
                        break;
                    case 'hard':
                        timeLeft = 15;
                        break;
                    default:
                        timeLeft = 20;
                        break;
                }
            }
            
            updateTimer();
            
            timerInterval = setInterval(() => {
                timeLeft -= 0.1;
                updateTimer();
                
                if (timeLeft <= 0) {
                    clearInterval(timerInterval);
                    timeUp();
                }
            }, 100);
        }

        // æ›´æ–°è®¡æ—¶å™¨æ˜¾ç¤º
        function updateTimer() {
            if (isTimerEnabled) {
                countdown.textContent = `å€’è®¡æ—¶ ${Math.max(0, timeLeft).toFixed(1)}`;
                
                // æ—¶é—´ä¸è¶³æ—¶å˜çº¢
                if (timeLeft <= 5) {
                    countdown.parentElement.className = 'bg-danger text-white px-6 py-3 rounded-full shadow-md';
                } else {
                    countdown.parentElement.className = 'bg-accent text-white px-6 py-3 rounded-full shadow-md';
                }
            } else {
                countdown.textContent = 'æ— é™åˆ¶';
                countdown.parentElement.className = 'bg-gray-500 text-white px-6 py-3 rounded-full shadow-md';
            }
        }

        // æ—¶é—´åˆ°
        function timeUp() {
            if (!gameActive) return;
            
            gameActive = false;
            combo = 0;
            
            // é«˜äº®æ­£ç¡®ç­”æ¡ˆ
            Array.from(optionsContainer.children).forEach(btn => {
                if (btn.textContent === currentPinyin) {
                    btn.style.backgroundColor = '#66BB6A';
                    btn.style.color = 'white';
                } else {
                    btn.style.backgroundColor = '#EF5350';
                    btn.style.color = 'white';
                }
            });
            
            showFeedback(false, 'æ—¶é—´åˆ°ï¼', `${currentCharacter} çš„æ­£ç¡®æ‹¼éŸ³æ˜¯ ${currentPinyin}`);
            updateUI();
            
            // æ’­æ”¾è¯»éŸ³
            setTimeout(() => {
                playCurrentSound();
            }, 500);
            
            // å»¶è¿Ÿè¿›å…¥ä¸‹ä¸€é¢˜
            setTimeout(() => {
                gameActive = true;
                nextQuestion();
            }, 3000);
        }

        // æ’­æ”¾å½“å‰æ±‰å­—æˆ–æ‹¼éŸ³çš„è¯»éŸ³
        function playCurrentSound() {
            // ä½¿ç”¨Web Speech APIæ’­æ”¾è¯»éŸ³
            if ('speechSynthesis' in window) {
                let textToSpeak;
                
                if (currentGameMode === 'consonants' || currentGameMode === 'vowels') {
                    // åŸºç¡€å­¦ä¹ æ¨¡å¼ï¼šæ’­æ”¾æ‹¼éŸ³å­—æ¯çš„éŸ³
                    const currentData = basicLearningData[currentGameMode].data.find(item => item.char === currentCharacter);
                    textToSpeak = currentData ? currentData.sound : currentCharacter;
                } else {
                    // ç»¼åˆç»ƒä¹ æ¨¡å¼ï¼šæ’­æ”¾æ±‰å­—
                    textToSpeak = currentCharacter;
                }
                
                // å…ˆåœæ­¢æ‰€æœ‰æ­£åœ¨æ’­æ”¾çš„è¯­éŸ³
                speechSynthesis.cancel();
                
                const utterance = new SpeechSynthesisUtterance(textToSpeak);
                
                // è®¾ç½®ä¸­æ–‡è¯­éŸ³å‚æ•°
                utterance.lang = 'zh-CN';
                utterance.rate = 0.6; // é€‚åˆå„¿ç«¥çš„æ…¢é€Ÿ
                utterance.pitch = 1.1; // ç¨é«˜éŸ³è°ƒ
                utterance.volume = 0.9;
                
                // å°è¯•é€‰æ‹©ä¸­æ–‡è¯­éŸ³
                utterance.onvoiceschanged = () => {
                    const voices = speechSynthesis.getVoices();
                    const chineseVoice = voices.find(voice => 
                        voice.lang === 'zh-CN' || voice.lang === 'zh' || 
                        voice.name.includes('Chinese') || voice.name.includes('ä¸­æ–‡')
                    );
                    if (chineseVoice) {
                        utterance.voice = chineseVoice;
                    }
                };
                
                // å¦‚æœè¯­éŸ³åˆ—è¡¨å·²åŠ è½½ï¼Œç›´æ¥è®¾ç½®
                const voices = speechSynthesis.getVoices();
                if (voices.length > 0) {
                    const chineseVoice = voices.find(voice => 
                        voice.lang === 'zh-CN' || voice.lang === 'zh' || 
                        voice.name.includes('Chinese') || voice.name.includes('ä¸­æ–‡')
                    );
                    if (chineseVoice) {
                        utterance.voice = chineseVoice;
                    }
                }
                
                // è®¾ç½®ä¸åŒæ¨¡å¼çš„è¯­é€Ÿ
                if (currentGameMode === 'consonants' || currentGameMode === 'vowels') {
                    utterance.rate = 0.5; // åŸºç¡€å­¦ä¹ æ›´æ…¢
                }
                
                speechSynthesis.speak(utterance);
                
                // æ·»åŠ åŠ¨ç”»æ•ˆæœ
                playSoundBtn.classList.add('sound-wave');
                setTimeout(() => {
                    playSoundBtn.classList.remove('sound-wave');
                }, 1500);
            } else {
                // å¦‚æœä¸æ”¯æŒè¯­éŸ³åˆæˆï¼Œæ˜¾ç¤ºæç¤º
                console.log('æµè§ˆå™¨ä¸æ”¯æŒè¯­éŸ³åˆæˆåŠŸèƒ½');
                alert('æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒè¯­éŸ³åŠŸèƒ½ï¼Œè¯·å°è¯•ä½¿ç”¨Chromeæˆ–Safariæµè§ˆå™¨');
            }
        }

        // æ›´æ–°UIæ˜¾ç¤º
        function updateUI() {
            levelDisplay.textContent = currentQuestion;
            comboDisplay.textContent = combo;
            scoreDisplay.textContent = score;
            currentQuestionSpan.textContent = currentQuestion;
            totalQuestionsSpan.textContent = totalQuestions;
        }

        // æ›´æ–°è¿›åº¦æ¡
        function updateProgress() {
            const progress = (currentQuestion / totalQuestions) * 100;
            progressBar.style.width = `${progress}%`;
        }

        // ç»“æŸæ¸¸æˆ
        function endGame() {
            showScreen('result');
            
            // è®¡ç®—å‡†ç¡®ç‡
            const accuracy = Math.round((correctAnswers / totalQuestions) * 100);
            
            // æ˜¾ç¤ºç»“æœ
            document.getElementById('final-score').textContent = score;
            document.getElementById('accuracy-rate').textContent = accuracy + '%';
            document.getElementById('max-combo').textContent = maxCombo;
            document.getElementById('level-reached').textContent = currentQuestion;
            
            // æ ¹æ®æˆç»©æ˜¾ç¤ºä¸åŒçš„ç»“æœ
            const resultIcon = document.getElementById('result-icon');
            const resultEmoji = document.getElementById('result-emoji');
            const resultTitle = document.getElementById('result-title');
            const resultSubtitle = document.getElementById('result-subtitle');
            
            if (accuracy >= 90) {
                resultIcon.className = 'w-24 h-24 mx-auto rounded-full flex items-center justify-center text-4xl text-white shadow-lg mb-4 bg-gradient-to-br from-yellow-400 to-orange-500';
                resultEmoji.className = 'fa fa-trophy';
                resultTitle.textContent = 'æ‹¼éŸ³å°è¾¾äººï¼';
                resultSubtitle.textContent = 'ä½ çš„æ‹¼éŸ³æ°´å¹³çœŸæ˜¯å¤ªæ£’äº†ï¼';
            } else if (accuracy >= 70) {
                resultIcon.className = 'w-24 h-24 mx-auto rounded-full flex items-center justify-center text-4xl text-white shadow-lg mb-4 bg-gradient-to-br from-green-400 to-blue-500';
                resultEmoji.className = 'fa fa-star';
                resultTitle.textContent = 'è¡¨ç°ä¼˜ç§€ï¼';
                resultSubtitle.textContent = 'ç»§ç»­åŠªåŠ›ï¼Œä½ ä¼šæ›´æ£’çš„ï¼';
            } else if (accuracy >= 50) {
                resultIcon.className = 'w-24 h-24 mx-auto rounded-full flex items-center justify-center text-4xl text-white shadow-lg mb-4 bg-gradient-to-br from-blue-400 to-purple-500';
                resultEmoji.className = 'fa fa-thumbs-up';
                resultTitle.textContent = 'ç»§ç»­åŠ æ²¹ï¼';
                resultSubtitle.textContent = 'å¤šå¬å¤šç»ƒï¼Œæ‹¼éŸ³ä¼šè¶Šæ¥è¶Šå¥½ï¼';
            } else {
                resultIcon.className = 'w-24 h-24 mx-auto rounded-full flex items-center justify-center text-4xl text-white shadow-lg mb-4 bg-gradient-to-br from-pink-400 to-red-500';
                resultEmoji.className = 'fa fa-heart';
                resultTitle.textContent = 'å†è¯•ä¸€æ¬¡ï¼';
                resultSubtitle.textContent = 'æ²¡å…³ç³»ï¼Œå­¦ä¹ éœ€è¦æ—¶é—´å’Œè€å¿ƒï¼';
            }
        }

        // é¡µé¢åŠ è½½æ—¶åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>